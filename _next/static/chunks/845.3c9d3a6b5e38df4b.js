(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[845],{9821:function(m,v,w){"use strict";let E=w(4579).parse,C=w(7799).compile,S=w(7094).segment,A=w(1105);m.exports={parse:E,compile:C,segment:S,hls:A}},7799:function(m){"use strict";function CompilerError(m,v){this.message=m,this.error=v}function convertTimestamp(m){let v=pad(Math.floor(m/60/60),2),w=pad(Math.floor(m/60)%60,2),E=pad(Math.floor(m%60),2),C=pad(Math.floor(1e3*(m%1).toFixed(4)),3);return`${v}:${w}:${E}.${C}`}function pad(m,v){let w=`${m}`;for(;w.length<v;)w=`0${w}`;return w}CompilerError.prototype=Object.create(Error.prototype),m.exports={CompilerError,compile:function(m){if(!m)throw new CompilerError("Input must be non-null");if("object"!=typeof m)throw new CompilerError("Input must be an object");if(Array.isArray(m))throw new CompilerError("Input cannot be array");if(!m.valid)throw new CompilerError("Input must be valid");let v="WEBVTT\n";if(m.meta){if("object"!=typeof m.meta||Array.isArray(m.meta))throw new CompilerError("Metadata must be an object");Object.entries(m.meta).forEach(m=>{if("string"!=typeof m[1])throw new CompilerError(`Metadata value for "${m[0]}" must be string`);v+=`${m[0]}: ${m[1]}
`})}let w=null;return m.cues.forEach((m,E)=>{if(w&&w>m.start)throw new CompilerError(`Cue number ${E} is not in chronological order`);w=m.start,v+="\n"+function(m){if("object"!=typeof m)throw new CompilerError("Cue malformed: not of type object");if("string"!=typeof m.identifier&&"number"!=typeof m.identifier&&null!==m.identifier)throw new CompilerError(`Cue malformed: identifier value is not a string.
    ${JSON.stringify(m)}`);if(isNaN(m.start))throw new CompilerError(`Cue malformed: null start value.
    ${JSON.stringify(m)}`);if(isNaN(m.end))throw new CompilerError(`Cue malformed: null end value.
    ${JSON.stringify(m)}`);if(m.start>=m.end)throw new CompilerError(`Cue malformed: start timestamp greater than end
    ${JSON.stringify(m)}`);if("string"!=typeof m.text)throw new CompilerError(`Cue malformed: null text value.
    ${JSON.stringify(m)}`);if("string"!=typeof m.styles)throw new CompilerError(`Cue malformed: null styles value.
    ${JSON.stringify(m)}`);let v="";m.identifier.length>0&&(v+=`${m.identifier}
`);let w=convertTimestamp(m.start),E=convertTimestamp(m.end);return v+(`${w} --> ${E}`+(m.styles?` ${m.styles}`:""))+`
${m.text}`}(m)+"\n"}),v}}},1105:function(m,v,w){"use strict";let E=w(7094).segment;function pad(m,v){let w="0".repeat(Math.max(0,v-m.toString().length));return`${w}${m}`}function printableTimestamp(m){let v=(m%1).toFixed(3);m=Math.round(m-v);let w=Math.floor(m/3600),E=Math.floor((m-3600*w)/60),C=m-3600*w-60*E,S=`${pad(w,2)}:`;return`${S}${pad(E,2)}:${pad(C,2)}.${pad(1e3*v,3)}`}m.exports={hlsSegment:function(m,v,w){void 0===w&&(w="900000");let C=E(m,v),S=[];return C.forEach((m,v)=>{let E=`WEBVTT
X-TIMESTAMP-MAP=MPEGTS:${w},LOCAL:00:00:00.000

${function(m){let v=[];return m.forEach(m=>{v.push(function(m){let v=[];m.identifier&&v.push(m.identifier);let w=printableTimestamp(m.start),E=printableTimestamp(m.end),C=m.styles?`${m.styles}`:"";return v.push(`${w} --> ${E} ${C}`),v.push(m.text),v.join("\n")}(m))}),v.join("\n\n")}(m.cues)}
`,C=`${v}.vtt`;S.push({filename:C,content:E})}),S},hlsSegmentPlaylist:function(m,v){let w;let C=E(m,v),S=function(m){let v=[];return m.forEach((m,w)=>{v.push(`#EXTINF:${m.duration.toFixed(5)},
${w}.vtt`)}),v.join("\n")}(C),A=Math.round((w=0,C.forEach(m=>{m.duration>w&&(w=m.duration)}),w)),_=`#EXTM3U
#EXT-X-TARGETDURATION:${A}
#EXT-X-VERSION:3
#EXT-X-MEDIA-SEQUENCE:0
#EXT-X-PLAYLIST-TYPE:VOD
${S}
#EXT-X-ENDLIST
`;return _}}},4579:function(m){"use strict";function ParserError(m,v){this.message=m,this.error=v}ParserError.prototype=Object.create(Error.prototype);let v=/([0-9]+)?:?([0-9]{2}):([0-9]{2}\.[0-9]{2,3})/;function parseTimestamp(m){let w=m.match(v);return 3600*parseFloat(w[1]||0)+(60*parseFloat(w[2])+parseFloat(w[3]))}m.exports={ParserError,parse:function(m,w){w||(w={});let{meta:E=!1,strict:C=!0}=w;if("string"!=typeof m)throw new ParserError("Input must be a string");m=(m=(m=m.trim()).replace(/\r\n/g,"\n")).replace(/\r/g,"\n");let S=m.split("\n\n"),A=S.shift();if(!A.startsWith("WEBVTT"))throw new ParserError('Must start with "WEBVTT"');let _=A.split("\n"),k=_[0].replace("WEBVTT","");if(k.length>0&&" "!==k[0]&&"	"!==k[0])throw new ParserError("Header comment must start with space or tab");if(0===S.length&&1===_.length)return{valid:!0,strict:C,cues:[],errors:[]};if(!E&&_.length>1&&""!==_[1])throw new ParserError("Missing blank line after signature");let{cues:I,errors:P}=function(m,w){let E=[],C=m.map((m,C)=>{try{return function(m,w,E){var C,S;let A="",_=0,k=.01,I="",P="",T=m.split("\n").filter(Boolean);if(T.length>0&&T[0].trim().startsWith("NOTE"))return null;if(1===T.length&&!T[0].includes("-->"))throw new ParserError(`Cue identifier cannot be standalone (cue #${w})`);if(T.length>1&&!(T[0].includes("-->")||T[1].includes("-->"))){let m=`Cue identifier needs to be followed by timestamp (cue #${w})`;throw new ParserError(m)}T.length>1&&T[1].includes("-->")&&(A=T.shift());let R="string"==typeof T[0]&&T[0].split(" --> ");if(2!==R.length||(C=R[0],!v.test(C))||(S=R[1],!v.test(S)))throw new ParserError(`Invalid cue timestamp (cue #${w})`);if(_=parseTimestamp(R[0]),k=parseTimestamp(R[1]),E){if(_>k)throw new ParserError(`Start timestamp greater than end (cue #${w})`);if(k<=_)throw new ParserError(`End must be greater than start (cue #${w})`)}if(!E&&k<_)throw new ParserError(`End must be greater or equal to start when not strict (cue #${w})`);return P=R[1].replace(v,"").trim(),T.shift(),!!(I=T.join("\n"))&&{identifier:A,start:_,end:k,text:I,styles:P}}(m,C,w)}catch(m){return E.push(m),null}}).filter(Boolean);return{cues:C,errors:E}}(S,C);if(C&&P.length>0)throw P[0];let T=E?function(m){let v={};return m.slice(1).forEach(m=>{let w=m.indexOf(":"),E=m.slice(0,w).trim(),C=m.slice(w+1).trim();v[E]=C}),Object.keys(v).length>0?v:null}(_):null,R={valid:0===P.length,strict:C,cues:I,errors:P};return E&&(R.meta=T),R}}},7094:function(m,v,w){"use strict";let E=w(4579).parse;m.exports={segment:function(m,v){v=v||10;let w=E(m),C=[],S=[],A=null,_=0,k=0;return w.cues.forEach((m,E)=>{let I=0===E,P=E===w.cues.length-1,T=m.start,R=m.end,O=P?1/0:w.cues[E+1].start,z=I?R:R-T,L=I?0:T-w.cues[E-1].end;_=_+z+L,C.length,A&&(S.push(A),_+=A.end-k,A=null),S.push(m);let F=O-R<v&&L<v&&_>v;if(function(m,v,w,E){return(E<=v||E+(v-E%v)+m<w)&&w-m>=v}(k,v,O,L)){var N,q,Z,Q;let m;let w=(N=v,q=_,Z=k,m=N,q>N&&(m=(Q=q-N)+(N-Q%N)),m=P?parseFloat((R-Z).toFixed(2)):Math.round(m));C.push({duration:w,cues:S}),k+=w,_=0,S=[]}else F=!1;F&&(A=m)}),C}}},4887:function(m,v){!function(m){"use strict";function t(m){return null==m}function r(m){throw Error("Argument "+m+" is empty.")}function e(m){return"function"==typeof m&&"getType"in m}function i(m){throw Error("Argument "+m+' is invalid, it should be an action-creator instance from "typesafe-actions"')}function o(m,v){if(null==m)throw Error("Argument contains array with empty element at index "+v);if(null==m.getType)throw Error("Argument contains array with invalid element at index "+v+', it should be an action-creator instance from "typesafe-actions"')}function u(m){return"string"==typeof m||"symbol"==typeof m}function c(m){throw Error("Argument "+m+" is invalid, it should be an action type of type: string | symbol")}function f(m,v){if(null==m)throw Error("Argument contains array with empty element at index "+v);if("string"!=typeof m&&"symbol"!=typeof m)throw Error("Argument contains array with invalid element at index "+v+", it should be of type: string | symbol")}function s(m,v,w,E){return t(m)&&r(1),u(m)||i(1),{type:m,payload:v,meta:w,error:E}}function y(m,v){return t(m)&&r(1),u(m)||c(1),Object.assign(function(){var w=null!=v?v.apply(void 0,arguments):void 0;return Object.assign({type:m},w)},{getType:function(){return m},toString:function(){return m}})}function l(m,v,w){return t(m)&&r(1),u(m)||c(1),function(){return y(m,function(){var m=arguments.length<=0?void 0:arguments[0],E=arguments.length<=1?void 0:arguments[1];return null==v&&null==w||(m=null!=v?v.apply(void 0,arguments):void 0,E=null!=w?w.apply(void 0,arguments):void 0),Object.assign({},void 0!==m&&{payload:m},{},void 0!==E&&{meta:E})})}}function p(m){return t(m)&&r(1),e(m)||i(1),m.getType()}function d(m,v){return t(m)&&r(1),u(m)||c(1),Object.assign(null!=v?v(m):function(){return{type:m}},{getType:function(){return m},toString:function(){return m}})}m.action=s,m.createAction=l,m.createAsyncAction=function(m,v,w,E){return function(){var C=[m,v,w,E].map(function(m,v){return Array.isArray(m)?l(m[0],m[1],m[2])():"string"==typeof m||"symbol"==typeof m?l(m)():void(v<3&&function(m){throw Error("Argument "+m+' is invalid, it should be an action type of "string | symbol" or a tuple of "[string | symbol, Function, Function?]"')}(v))});return{request:C[0],success:C[1],failure:C[2],cancel:C[3]}}},m.createCustomAction=y,m.createReducer=function n(m,v){void 0===v&&(v={});var w=Object.assign({},v),o=function(v,E){var C=Array.isArray(v)?v:[v],S={};return C.map(function(m,v){return e(m)?p(m):u(m)?m:function(m){throw Error("Argument "+m+' is invalid, it should be an action-creator instance from "typesafe-actions" or action type of type: string | symbol')}(v+1)}).forEach(function(m){return S[m]=E}),n(m,Object.assign({},w,{},S))};return Object.assign(function(v,E){if(void 0===v&&(v=m),w.hasOwnProperty(E.type)){var C=w[E.type];if("function"!=typeof C)throw Error('Reducer under "'+E.type+'" key is not a valid reducer');return C(v,E)}return v},{handlers:Object.assign({},w),handleAction:o,handleType:o})},m.deprecated={createAction:function(m,v){return Object.assign(null==v?function(){return s(m)}:v(s.bind(null,m)),{getType:function(){return m},toString:function(){return m}})},createCustomAction:d,createStandardAction:function(m){return t(m)&&r(1),u(m)||c(1),Object.assign(function(){return d(m,function(m){return function(v,w){return{type:m,payload:v,meta:w}}})},{map:function(v){return d(m,function(m){return function(w,E){return Object.assign(v(w,E),{type:m})}})}})}},m.getType=p,m.isActionOf=function(m,v){t(m)&&r(1);var w=Array.isArray(m)?m:[m];w.forEach(o);var u=function(m){return w.some(function(v){return m.type===v.getType()})};return void 0===v?u:u(v)},m.isOfType=function(m,v){t(m)&&r(1);var w=Array.isArray(m)?m:[m];w.forEach(f);var o=function(m){return w.includes(m.type)};return void 0===v?o:o(v)}}(v)},3845:function(m,v,w){"use strict";let E;w.r(v),w.d(v,{Image:function(){return se},Primitives:function(){return ep.default},Scroll:function(){return zt},Slider:function(){return rC.default},Viewer:function(){return da},default:function(){return nq}});var C,S,A,_,k,I,P=w(9203),T=w(4511),R=w(6744),O=w(7294);let z="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var L={randomUUID:z};let F=new Uint8Array(16),N=[];for(let m=0;m<256;++m)N.push((m+256).toString(16).slice(1));var esm_browser_v4=function(m,v,w){if(L.randomUUID&&!v&&!m)return L.randomUUID();m=m||{};let C=m.random||(m.rng||function(){if(!E&&!(E="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return E(F)})();if(C[6]=15&C[6]|64,C[8]=63&C[8]|128,v){w=w||0;for(let m=0;m<16;++m)v[w+m]=C[m];return v}return function(m,v=0){return N[m[v+0]]+N[m[v+1]]+N[m[v+2]]+N[m[v+3]]+"-"+N[m[v+4]]+N[m[v+5]]+"-"+N[m[v+6]]+N[m[v+7]]+"-"+N[m[v+8]]+N[m[v+9]]+"-"+N[m[v+10]]+N[m[v+11]]+N[m[v+12]]+N[m[v+13]]+N[m[v+14]]+N[m[v+15]]}(C)};let q=window.OpenSeadragon;if(!q&&!(q=P))throw Error("OpenSeadragon is missing.");let Z="http://www.w3.org/2000/svg";q.Viewer&&(q.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo||(this._svgOverlayInfo=new y(this)),this._svgOverlayInfo});let y=function(m){let v=this;this._viewer=m,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(Z,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(Z,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){v.resize()}),this._viewer.addHandler("open",function(){v.resize()}),this._viewer.addHandler("rotate",function(){v.resize()}),this._viewer.addHandler("flip",function(){v.resize()}),this._viewer.addHandler("resize",function(){v.resize()}),this.resize()};y.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));let m=this._viewer.viewport.pixelFromPoint(new q.Point(0,0),!0),v=this._viewer.viewport.getZoom(!0),w=this._viewer.viewport.getRotation(),E=this._viewer.viewport.getFlip(),C=this._viewer.viewport._containerInnerSize.x,S=C*v,A=S;E&&(S=-S,m.x=-m.x+C),this._node.setAttribute("transform","translate("+m.x+","+m.y+") scale("+S+","+A+") rotate("+w+")")},onClick:function(m,v){new q.MouseTracker({element:m,clickHandler:v}).setTracking(!0)}};let b=m=>fetch(`${m.replace(/\/$/,"")}/info.json`).then(m=>m.json()).then(m=>m).catch(v=>{console.error(`The IIIF tilesource ${m.replace(/\/$/,"")}/info.json failed to load: ${v}`)}),H=m=>{let v,w;return Array.isArray(m)&&(v=m[0])&&(w="@id"in v?v["@id"]:v.id),w};var Q=((C=Q||{}).TiledImage="tiledImage",C.SimpleImage="simpleImage",C);let M=m=>{let v=Array.isArray(null==m?void 0:m.service)&&(null==m?void 0:m.service.length)>0,w=v?H(null==m?void 0:m.service):null==m?void 0:m.id,E=v?Q.TiledImage:Q.SimpleImage;return{uri:w,imageType:E}},B=(m,v)=>{let w=v?Q.TiledImage:Q.SimpleImage;return{uri:m,imageType:w}},{styled:K,css:et,keyframes:er,createTheme:ei}=(0,R.Th)({theme:{colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"hsl(209 100% 38.2%)",accentMuted:"hsl(209 80% 61.8%)",accentAlt:"hsl(209 80% 30%)",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},media:{xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"}}),en=K("div",{display:"flex",flexDirection:"column",alignItems:"center"}),ea=K("p",{fontWeight:"bold",fontSize:"x-large"}),eo=K("span",{fontSize:"medium"}),W=({error:m})=>{let{message:v}=m;return O.createElement(en,{role:"alert"},O.createElement(ea,{"data-testid":"headline"},"Something went wrong"),v&&O.createElement(eo,null,`Error message: ${v}`," "))},el=K("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),es=K("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),ec=K("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${el}`]:{display:"block"}},false:{[`${el}`]:{display:"none"}}}}}),ed=K("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),h=({className:m,id:v,label:w,children:E})=>{let C=w.toLowerCase().replace(/\s/g,"-");return O.createElement(ed,{id:v,className:m,"data-testid":"openseadragon-button","data-button":C},O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${v}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},O.createElement("title",{id:`${v}-svg-title`},w),E))},eu=K("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),j=()=>O.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),V=()=>O.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),U=()=>O.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),D=()=>O.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),$=()=>O.createElement(O.Fragment,null,O.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),O.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),X=({_cloverViewerHasPlaceholder:m,config:v})=>O.createElement(eu,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:m},v.showZoomControl&&O.createElement(O.Fragment,null,O.createElement(h,{id:v.zoomInButton,label:"zoom in"},O.createElement(j,null)),O.createElement(h,{id:v.zoomOutButton,label:"zoom out"},O.createElement(V,null))),v.showFullPageControl&&O.createElement(h,{id:v.fullPageButton,label:"full page"},O.createElement(U,null)),v.showRotationControl&&O.createElement(O.Fragment,null,O.createElement(h,{id:v.rotateRightButton,label:"rotate right"},O.createElement($,null)),O.createElement(h,{id:v.rotateLeftButton,label:"rotate left"},O.createElement($,null))),v.showHomeControl&&O.createElement(h,{id:v.homeButton,label:"reset"},O.createElement(D,null))),Y=({ariaLabel:m,config:v,uri:w,_cloverViewerHasPlaceholder:E,imageType:C,openSeadragonCallback:S})=>{let[A,_]=(0,O.useState)(),[k,I]=(0,O.useState)();return(0,O.useEffect)(()=>(k||I(P(v)),()=>null==k?void 0:k.destroy()),[]),(0,O.useEffect)(()=>{k&&S&&S(k)},[k,S]),(0,O.useEffect)(()=>{w!==A&&_(w)},[A,w]),(0,O.useEffect)(()=>{if(A&&k)switch(C){case"simpleImage":k.addSimpleImage({url:A});break;case"tiledImage":b(A).then(m=>{try{if(!m)throw Error(`No tile source found for ${A}`);k.addTiledImage({tileSource:m})}catch(m){console.error(m)}});break;default:k.close(),console.warn(`Unable to render ${A} in OpenSeadragon as type: "${C}"`)}},[C,A,k]),O.createElement(ec,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":v.id,hasNavigator:v.showNavigator},O.createElement(X,{_cloverViewerHasPlaceholder:E,config:v}),v.showNavigator&&O.createElement(el,{id:v.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),O.createElement(es,{id:v.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...m&&{"aria-label":m}}))},G=(m,v="none")=>{if(!m)return null;if("string"==typeof m)return[m];if(!m[v]){let v=Object.getOwnPropertyNames(m);if(v.length>0)return m[v[0]]}return m[v]&&Array.isArray(m[v])?m[v]:null},J=(m,v="none",w=", ")=>{let E=G(m,v);return Array.isArray(E)?E.join(`${w}`):E},se=({_cloverViewerHasPlaceholder:m=!1,body:v,instanceId:w,isTiledImage:E=!1,label:C,src:S="",openSeadragonCallback:A,openSeadragonConfig:_={}})=>{let k=w||esm_browser_v4(),I="string"==typeof C?C:J(C),P={id:`openseadragon-${k}`,navigatorId:`openseadragon-navigator-${k}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${k}`,homeButton:`reset-${k}`,rotateLeftButton:`rotateLeft-${k}`,rotateRightButton:`rotateRight-${k}`,zoomInButton:`zoomIn-${k}`,zoomOutButton:`zoomOut-${k}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1},..._},{imageType:R,uri:z}=v?M(v):B(S,E);return z?O.createElement(T.SV,{FallbackComponent:W},O.createElement(Y,{_cloverViewerHasPlaceholder:m,ariaLabel:I,config:P,imageType:R,key:k,uri:z,openSeadragonCallback:A})):null};var ep=w(1830),em=Object.defineProperty,__defNormalProp=(m,v,w)=>v in m?em(m,v,{enumerable:!0,configurable:!0,writable:!0,value:w}):m[v]=w,__publicField=(m,v,w)=>(__defNormalProp(m,"symbol"!=typeof v?v+"":v,w),w);let eh=[];Object.freeze(eh);let ef={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:eh,motivation:null,label:null,thumbnail:eh,summary:null,requiredStatement:null,metadata:eh,rights:null,provider:eh,items:eh,seeAlso:eh,homepage:eh,logo:eh,rendering:eh,service:eh},eg={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:eh,motivation:null,thumbnail:eh,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:eh,rights:null,navDate:null,provider:eh,items:eh,annotations:eh,seeAlso:eh,homepage:eh,logo:eh,partOf:eh,rendering:eh,service:eh,duration:0,height:0,width:0},ev={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:eh,motivation:null,thumbnail:eh,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:eh,rights:null,navDate:null,provider:eh,items:eh,annotations:eh,seeAlso:eh,homepage:eh,logo:eh,partOf:eh,rendering:eh,service:eh,services:eh},ey={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:eh,behavior:eh,homepage:eh,items:eh,label:null,logo:eh,metadata:eh,motivation:null,navDate:null,provider:eh,partOf:eh,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,rendering:eh,requiredStatement:null,rights:null,seeAlso:eh,service:eh,services:eh,start:null,structures:eh,summary:null,thumbnail:eh,viewingDirection:"left-to-right"},ew={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:eh,motivation:null,thumbnail:eh,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:eh,rights:null,navDate:null,provider:eh,items:eh,annotations:eh,seeAlso:eh,homepage:eh,logo:eh,partOf:eh,rendering:eh,service:eh,start:null,supplementary:null,viewingDirection:"left-to-right"},eb={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:eh,seeAlso:eh,homepage:eh};function ensureArray$1(m){return Array.isArray(m)?m:[m]}let ex=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];let Traverse$1=class Traverse$1{constructor(m,v={}){__publicField(this,"traversals"),__publicField(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[],...m},this.options={allowUndefinedReturn:!1,...v}}static all(m){return new Traverse$1({collection:[m],manifest:[m],canvas:[m],annotationCollection:[m],annotationPage:[m],annotation:[m],contentResource:[m],choice:[m],range:[m],service:[m]})}traverseDescriptive(m){return m.thumbnail&&(m.thumbnail=m.thumbnail.map(m=>this.traverseType(m,this.traversals.contentResource))),m.provider&&(m.provider=m.provider.map(m=>this.traverseAgent(m))),m}traverseLinking(m){return m.seeAlso&&(m.seeAlso=m.seeAlso.map(m=>this.traverseType(m,this.traversals.contentResource))),m.service&&(m.service=ensureArray$1(m.service).map(m=>this.traverseType(m,this.traversals.service))),m.services&&(m.services=m.services.map(m=>this.traverseType(m,this.traversals.service))),m.logo&&(m.logo=m.logo.map(m=>this.traverseType(m,this.traversals.contentResource))),m.homepage&&(m.homepage=m.homepage.map(m=>this.traverseType(m,this.traversals.contentResource))),m.partOf&&(m.partOf=m.partOf.map(m=>"string"!=typeof m&&m.type?"Canvas"===m.type?this.traverseType(m,this.traversals.canvas):"AnnotationCollection"===m.type?this.traverseType(m,this.traversals.annotationCollection):"Collection"===m.type?this.traverseType(m,this.traversals.collection):this.traverseType(m,this.traversals.contentResource):this.traverseType(m,this.traversals.contentResource))),m.start&&(m.start=m.start?this.traverseType(m.start,this.traversals.canvas):null),m.rendering&&(m.rendering=m.rendering.map(m=>this.traverseType(m,this.traversals.contentResource))),m.supplementary&&(m.supplementary=m.supplementary.map(m=>this.traverseType(m,this.traversals.contentResource))),m}traverseCollectionItems(m){return m.items&&m.items.map(m=>"Collection"===m.type?this.traverseCollection(m):this.traverseManifest(m)),m}traverseCollection(m){return this.traverseType(this.traverseDescriptive(this.traverseInlineAnnotationPages(this.traverseLinking(this.traversePosterCanvas(this.traverseCollectionItems(m))))),this.traversals.collection)}traverseManifestItems(m){return m.items&&(m.items=m.items.map(m=>this.traverseCanvas(m))),m}traverseManifestStructures(m){return m.structures&&(m.structures=m.structures.map(m=>this.traverseRange(m))),m}traverseManifest(m){return this.traverseType(this.traverseInlineAnnotationPages(this.traverseManifestStructures(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(m)))))),this.traversals.manifest)}traverseCanvasItems(m){return m.items=(m.items||[]).map(m=>this.traverseAnnotationPage(m)),m}traverseInlineAnnotationPages(m){return"string"!=typeof m&&m&&m.annotations&&(m.annotations=m.annotations.map(m=>this.traverseAnnotationPage(m))),m}traverseCanvas(m){return this.traverseType(this.traverseInlineAnnotationPages(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(m))))),this.traversals.canvas)}traverseAnnotationPageItems(m){return m.items&&(m.items=m.items.map(m=>this.traverseAnnotation(m))),m}traverseAnnotationPage(m){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationPageItems(m))),this.traversals.annotationPage)}traverseAnnotationBody(m){return Array.isArray(m.body)?m.body=m.body.map(m=>this.traverseContentResource(m)):m.body&&(m.body=this.traverseContentResource(m.body)),m}traversePosterCanvas(m){return m.posterCanvas&&(m.posterCanvas=this.traverseCanvas(m.posterCanvas)),m.placeholderCanvas&&(m.placeholderCanvas=this.traverseCanvas(m.placeholderCanvas)),m.accompanyingCanvas&&(m.accompanyingCanvas=this.traverseCanvas(m.accompanyingCanvas)),m}traverseAnnotation(m){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(m)),this.traversals.annotation)}traverseContentResourceLinking(m){return"string"!=typeof m&&m&&m&&m.service&&(m.service=ensureArray$1(m.service||[]).map(m=>this.traverseType(m,this.traversals.service))),m}traverseContentResource(m){return"Choice"===m.type&&(m.items=m.items.map(m=>this.traverseContentResource(m))),this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(m)),this.traversals.contentResource)}traverseRangeRanges(m){return m.items&&(m.items=m.items.map(m=>"string"==typeof m?this.traverseCanvas({id:m,type:"Canvas"}):"Manifest"===m.type?this.traverseManifest(m):this.traverseRange(m))),m}traverseRange(m){return this.traverseType(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseRangeRanges(m)))),this.traversals.range)}traverseAgent(m){return this.traverseType(this.traverseDescriptive(this.traverseLinking(m)),this.traversals.agent)}traverseType(m,v){return v.reduce((m,v)=>{let w=v(m);return void 0!==w||this.options.allowUndefinedReturn?w:m},m)}traverseService(m){return this.traverseType(m,this.traversals.service)}traverseUnknown(m){let v=function(m){if(null==m)throw Error("Null or undefined is not a valid entity.");if(Array.isArray(m))throw Error("Array is not a valid entity");if("object"!=typeof m)throw Error(`${typeof m} is not a valid entity`);if("string"==typeof m.type){let v=ex.indexOf(m.type);if(-1!==v)return ex[v]}if(m.profile)return"Service";throw Error("Resource type is not known")}(m);switch(v){case"Collection":return this.traverseCollection(m);case"Manifest":return this.traverseManifest(m);case"Canvas":return this.traverseCanvas(m);case"AnnotationPage":return this.traverseAnnotationPage(m);case"Annotation":return this.traverseAnnotation(m);case"ContentResource":return this.traverseContentResource(m);case"Range":return this.traverseRange(m);case"Service":return this.traverseService(m);case"Agent":return this.traverseAgent(m);default:throw Error(`Unknown or unsupported resource type of ${v}`)}}};let eE=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];let Traverse=class Traverse{constructor(m,v={}){__publicField(this,"traversals"),__publicField(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...m},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...v}}static all(m){return new Traverse({collection:[m],manifest:[m],canvas:[m],annotationList:[m],sequence:[m],annotation:[m],contentResource:[m],choice:[m],range:[m],service:[m],layer:[m]})}traverseCollection(m){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(m))),this.traversals.collection)}traverseCollectionItems(m){if(this.options.mergeMemberProperties){let v=[...(m.manifests||[]).map(m=>"string"==typeof m?{"@id":m,"@type":"sc:Manifest"}:m),...(m.collections||[]).map(m=>"string"==typeof m?{"@id":m,"@type":"sc:Collection"}:m),...m.members||[]];delete m.collections,delete m.manifests,m.members=v}return m.manifests&&(m.manifests=m.manifests.map(m=>this.traverseManifest("string"==typeof m?{"@id":m,"@type":"sc:Manifest"}:m))),m.collections&&(m.collections=m.collections.map(m=>this.traverseCollection("string"==typeof m?{"@id":m,"@type":"sc:Collection"}:m))),m.members&&(m.members=m.members.map(m=>"string"==typeof m?m:this.traverseUnknown(m))),m}traverseManifest(m){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(m))),this.traversals.manifest)}traverseManifestItems(m){return m.sequences&&(m.sequences=m.sequences.map(m=>this.traverseSequence(m))),m.structures&&(m.structures=m.structures.map(m=>this.traverseRange(m))),m}traverseSequence(m){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(m))),this.traversals.sequence)}traverseSequenceItems(m){return m.canvases&&(m.canvases=m.canvases.map(m=>this.traverseCanvas(m))),m}traverseCanvas(m){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(m))),this.traversals.canvas)}traverseCanvasItems(m){return m.images&&(m.images=m.images.map(m=>this.traverseAnnotation(m))),m.otherContent&&(m.otherContent=m.otherContent.map(m=>this.traverseAnnotationList(m))),m}traverseRange(m){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(m))),this.traversals.range)}traverseRangeItems(m){if(this.options.mergeMemberProperties){let v=[...(m.ranges||[]).map(m=>"string"==typeof m?{"@id":m,"@type":"sc:Range"}:m),...(m.canvases||[]).map(m=>"string"==typeof m?{"@id":m,"@type":"sc:Canvas"}:m),...m.members||[]];delete m.ranges,delete m.canvases,m.members=v.length?v.map(m=>this.traverseUnknown(m)):void 0}return m}traverseAnnotationList(m){let v="string"==typeof m?{"@id":m,"@type":"sc:AnnotationList"}:m;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(v)),this.traversals.annotationList)}traverseAnnotationListItems(m){return m.resources&&(m.resources=m.resources.map(m=>this.traverseAnnotation(m))),m}traverseAnnotation(m){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(m))),this.traversals.annotation)}traverseAnnotationItems(m){return m.resource&&(Array.isArray(m.resource)?m.resource=m.resource.map(m=>this.traverseContentResource(m)):m.resource=this.traverseContentResource(m.resource)),m.on,m}traverseLayer(m){return this.traverseType(this.traverseLinking(this.traverseLayerItems(m)),this.traversals.layer)}traverseLayerItems(m){return m.otherContent&&(m.otherContent=m.otherContent.map(m=>this.traverseAnnotationList(m))),m}traverseChoice(m){return this.traverseType(this.traverseChoiceItems(m),this.traversals.choice)}traverseChoiceItems(m){return m.default&&"rdf:nil"!==m.default&&(m.default=this.traverseContentResource(m.default)),m.item&&"rdf:nil"!==m.item&&(m.item=m.item.map(m=>this.traverseContentResource(m))),m}traverseService(m){return this.traverseType(this.traverseLinking(m),this.traversals.service)}traverseContentResource(m){return"oa:Choice"===m["@type"]?this.traverseChoice(m):this.traverseType(this.traverseDescriptive(this.traverseLinking(m)),this.traversals.contentResource)}traverseUnknown(m){if(!m["@type"]||"string"==typeof m)return m;switch(function(m){if(null==m)throw Error("Null or undefined is not a valid entity.");if(Array.isArray(m))throw Error("Array is not a valid entity");if("object"!=typeof m)throw Error(`${typeof m} is not a valid entity`);if("string"==typeof m["@type"]){let v=eE.indexOf(m["@type"]);if(-1!==v)return eE[v]}if(m.profile)return"Service";if(m.format||m["@type"])return"ContentResource";throw Error("Resource type is not known")}(m)){case"sc:Collection":return this.traverseCollection(m);case"sc:Manifest":return this.traverseManifest(m);case"sc:Canvas":return this.traverseCanvas(m);case"sc:Sequence":return this.traverseSequence(m);case"sc:Range":return this.traverseRange(m);case"oa:Annotation":return this.traverseAnnotation(m);case"sc:AnnotationList":return this.traverseAnnotationList(m);case"sc:Layer":return this.traverseLayer(m);case"Service":return this.traverseService(m);case"oa:Choice":return this.traverseChoice(m);case"ContentResource":return this.traverseContentResource(m)}return m.profile?this.traverseService(m):m}traverseImageResource(m){let v=Array.isArray(m),w=Array.isArray(m)?m:[m],E=[];for(let m of w)"string"==typeof m?E.push(this.traverseContentResource({"@id":m,"@type":"dctypes:Image"})):E.push(this.traverseContentResource(m));return v||this.options.convertPropsToArray?E:E[0]}traverseDescriptive(m){return m.thumbnail&&(m.thumbnail=this.traverseImageResource(m.thumbnail)),m.logo&&(m.logo=this.traverseImageResource(m.logo)),m}traverseOneOrMoreServices(m){let v=Array.isArray(m),w=Array.isArray(m)?m:[m],E=[];for(let m of w)E.push(this.traverseService(m));return v||this.options.convertPropsToArray?E:E[0]}traverseLinking(m){return m.related&&(m.related=this.traverseOneOrManyType(m.related,this.traversals.contentResource)),m.rendering&&(m.rendering=this.traverseOneOrManyType(m.rendering,this.traversals.contentResource)),m.service&&(m.service=this.traverseOneOrMoreServices(m.service)),m.seeAlso&&(m.seeAlso=this.traverseOneOrManyType(m.seeAlso,this.traversals.contentResource)),m.within&&("string"==typeof m.within||(m.within=this.traverseOneOrManyType(m.within,this.traversals.contentResource))),m.startCanvas&&("string"==typeof m.startCanvas?m.startCanvas=this.traverseType({"@id":m.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):m.startCanvas&&this.traverseType(m.startCanvas,this.traversals.canvas)),m.contentLayer&&("string"==typeof m.contentLayer?m.contentLayer=this.traverseLayer({"@id":m.contentLayer,"@type":"sc:Layer"}):m.contentLayer=this.traverseLayer(m.contentLayer)),m}traverseOneOrManyType(m,v){if(!Array.isArray(m)){if(!this.options.convertPropsToArray)return this.traverseType(m,v);m=[m]}return m.map(m=>this.traverseType(m,v))}traverseType(m,v){return v.reduce((m,v)=>{let w=v(m);return void 0!==w||this.options.allowUndefinedReturn?w:m},m)}};let eC="http://library.stanford.edu/iiif/image-api/compliance.html#level1",eS="http://library.stanford.edu/iiif/image-api/compliance.html#level2",eA="http://library.stanford.edu/iiif/image-api/conformance.html#level1",e_="http://library.stanford.edu/iiif/image-api/conformance.html#level2",ek="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",eI="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",e$="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",eP="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",eT="http://iiif.io/api/image/1/level1.json",eR="http://iiif.io/api/image/1/profiles/level1.json",eO="http://iiif.io/api/image/1/level2.json",eM="http://iiif.io/api/image/1/profiles/level2.json",ez="http://iiif.io/api/image/2/level1.json",eL="http://iiif.io/api/image/2/profiles/level1.json",ej="http://iiif.io/api/image/2/level2.json",eF="http://iiif.io/api/image/2/profiles/level2.json",eH="level1",eN="level2",eB="http://iiif.io/api/image/2/level1",eD="http://iiif.io/api/image/2/level2",eW=[eB,eD,eC,eS,eA,e_,ek,eI,e$,eP,eT,eR,eO,eM,ez,eL,ej,eF,eH,eN],eV=["http://iiif.io/api/image/2/level0",eB,eD,"http://library.stanford.edu/iiif/image-api/compliance.html#level0",eC,eS,"http://library.stanford.edu/iiif/image-api/conformance.html#level0",eA,e_,"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",ek,eI,"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",e$,eP,"http://iiif.io/api/image/1/level0.json","http://iiif.io/api/image/1/profiles/level0.json",eT,eR,eO,eM,"http://iiif.io/api/image/2/level0.json","http://iiif.io/api/image/2/profiles/level0.json",ez,eL,ej,eF,"level0",eH,eN],eU={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:"Unknown"};function convertLanguageMapping(m,v="none"){if(!m)return{};let w=Array.isArray(m)?m:[m],E={};for(let m of w){if("string"==typeof m){E[v]=E[v]?E[v]:[],E[v].push(m||"");continue}if(!m["@language"]){E[v]=E[v]?E[v]:[],E[v].push(m["@value"]||"");continue}let w=m["@language"];E[w]=E[w]?E[w]:[],E[w].push(m["@value"]||"")}return E}function removePrefix(m){for(let v of["sc","oa","dcterms","dctypes","iiif"])if(m.startsWith(`${v}:`))return m.slice(v.length+1);return m}let eq=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function getNewType(m){let v=m["@id"]||m.id,w=m["@type"]||m.type,E=m.profile||void 0,C=m["@context"]||void 0;if(E){let m=function(m){switch(m){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}(E);if(m)return m}if(C){let m=function(m){let v=Array.isArray(m)?m:[m];for(let m of v)switch(m){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}(C);if(m)return m}if(w){if(Array.isArray(w)){if(-1!==w.indexOf("oa:CssStylesheet"))return"CssStylesheet";if(-1!==w.indexOf("cnt:ContentAsText"))return"TextualBody";w=w[0]}for(let m of["sc","oa","dcterms","dctypes","iiif"])if(w.startsWith(`${m}:`)){w=w.slice(m.length+1);break}switch(w){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(w&&-1!==eq.indexOf(w))return w;if(m.format){if(m.format.startsWith("image/"))return"Image";if(m.format.startsWith("text/")||"application/pdf"===m.format)return"Text";if(m.format.startsWith("application/"))return"Dataset"}return v&&(v.endsWith(".jpg")||v.endsWith(".png")||v.endsWith(".jpeg"))?"Image":w||"unknown"}let eG=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm,eZ=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function removeUndefinedProperties(m){for(let v in m)(void 0===m[v]||null===m[v])&&delete m[v];return m}let eX=0;function mintNewIdFromResource(m,v){let w=encodeURI(m.id||m["@id"]||"").trim();return w&&v?`${w}/${v}`:w||(eX++,`http://example.org/${m["@type"]}${v?`/${v}`:""}/${eX}`)}function technicalProperties$2(m){let v;let w=[...m.behavior||[]];return m.viewingHint&&w.push(m.viewingHint),Array.isArray(m.motivation)?v=m.motivation.map(removePrefix):m.motivation&&(v=removePrefix(m.motivation)),{"@context":m["@context"]?function(m){if(m){let v=Array.isArray(m)?m:[m],w=[];for(let m of v)"http://iiif.io/api/presentation/2/context.json"===m&&w.push("http://iiif.io/api/presentation/3/context.json"),-1===eZ.indexOf(m)&&w.push(m);if(v.length)return 1===w.length?w[0]:w}}(m["@context"]):void 0,id:(m["@id"]||mintNewIdFromResource(m)).trim(),type:getNewType(m),behavior:w.length?w:void 0,height:m.height?m.height:void 0,width:m.width?m.width:void 0,motivation:v,viewingDirection:m.viewingDirection,profile:m.profile,format:m.format?m.format:void 0,duration:void 0,timeMode:void 0}}function descriptiveProperties$2(m){var v;let[w,E]=function(m,v="Rights/License",w="none"){let E=null,C=[],S=Array.isArray(m)?m:[m];for(let m of S){let S=m?function(m){let v=m.match(eG);return v?v[0]:m}(m):void 0;if(S&&(-1!==S.indexOf("creativecommons.org")||-1!==S.indexOf("rightsstatements.org"))){E=S.startsWith("https://")?`http://${S.slice(8)}`:S;continue}S&&C.push({label:{[w]:[v]},value:{[w]:[S]}})}return[E,C]}(m.license),C=[...m.metadata&&(v=m.metadata)?v.map(m=>({label:convertLanguageMapping(m.label),value:convertLanguageMapping(m.value)})):[],...E];return{rights:w,metadata:C.length?C:void 0,label:m.label?convertLanguageMapping(m.label):void 0,requiredStatement:m.attribution?{label:convertLanguageMapping(eU.attributionLabel),value:convertLanguageMapping(m.attribution)}:void 0,navDate:m.navDate,summary:m.description?convertLanguageMapping(m.description):void 0,thumbnail:m.thumbnail}}function linkingProperties$2(m){let v=m.related?Array.isArray(m.related)?m.related:[m.related]:[],w=m.contentLayer;return{provider:m.logo||v.length?[{id:eU.providerId,type:"Agent",homepage:v.length?[v[0]]:void 0,logo:m.logo?Array.isArray(m.logo)?m.logo:[m.logo]:void 0,label:convertLanguageMapping(eU.providerName)}]:void 0,partOf:function(m){if(!m.within)return;let v=Array.isArray(m.within)?m.within:[m.within],w=[];for(let E of v)"string"==typeof E?E&&"sc:Manifest"===m["@type"]&&w.push({id:E,type:"Collection"}):E["@id"]&&w.push({id:E["@id"],type:getNewType(E)});return w.length?w:void 0}(m),rendering:m.rendering,seeAlso:m.seeAlso,start:m.startCanvas,service:m.service?ensureArray$1(m.service):void 0,supplementary:w?[w]:void 0}}function upgradeContentResource(m){return removeUndefinedProperties({...technicalProperties$2(m),...descriptiveProperties$2(m),...linkingProperties$2(m),chars:m.chars,format:m.format?m.format:void 0,language:m.language})}let eQ=new Traverse({collection:[function(m){return removeUndefinedProperties({...technicalProperties$2(m),...descriptiveProperties$2(m),...linkingProperties$2(m),items:m.members})}],manifest:[function(m){let v=[],w=[];for(let E of m.sequences||[])E.canvases.length&&v.push(...E.canvases),E.behavior&&w.push(...E.behavior);let E=technicalProperties$2(m);return w.length&&(E.behavior?E.behavior.push(...w):E.behavior=w),removeUndefinedProperties({...E,...descriptiveProperties$2(m),...linkingProperties$2(m),items:v,structures:m.structures})}],canvas:[function(m){return removeUndefinedProperties({...technicalProperties$2(m),...descriptiveProperties$2(m),...linkingProperties$2(m),annotations:m.otherContent&&m.otherContent.length?m.otherContent:void 0,items:m.images&&m.images.length?[{id:mintNewIdFromResource(m,"annotation-page"),type:"AnnotationPage",items:m.images}]:void 0})}],annotationList:[function(m){return removeUndefinedProperties({...technicalProperties$2(m),...descriptiveProperties$2(m),...linkingProperties$2(m),items:m.resources&&m.resources.length?m.resources:void 0})}],sequence:[function(m){return m.canvases&&0!==m.canvases.length?{canvases:m.canvases,behavior:m.viewingHint?[m.viewingHint]:[]}:{canvases:[],behavior:[]}}],annotation:[function(m){return removeUndefinedProperties({...technicalProperties$2(m),...descriptiveProperties$2(m),...linkingProperties$2(m),target:function upgradeTarget(m){if(Array.isArray(m)){if(m.length>1)return{type:"List",items:m.map(upgradeTarget)};m=m[0]}if("string"==typeof m)return encodeURI(m).trim();if(!("@type"in m))return encodeURI(m["@id"]).trim();{let v;if("string"==typeof m.full)v=m.full;else if("dctypes:Image"===m.full["@type"])v={id:m.full["@id"],type:"Image"};else if("sc:Canvas"===m.full["@type"])v={id:m.full["@id"],type:"Canvas"};else throw Error(`Unsupported source type on annotation: ${m.full["@type"]}`);return{type:"SpecificResource",source:v,selector:function upgradeSelector(m){let v=(Array.isArray(m["@type"])&&m["@type"].includes("oa:SvgSelector")||"oa:SvgSelector"==m["@type"])&&("chars"in m||"value"in m);if(v)return{type:"SvgSelector",value:"chars"in m?m.chars:m.value};if("oa:FragmentSelector"===m["@type"])return{type:"FragmentSelector",value:m.value};if("oa:Choice"===m["@type"])return[upgradeSelector(m.default),...(Array.isArray(m.item)?m.item:[m.item]).map(upgradeSelector)];if("iiif:ImageApiSelector"==m["@type"])return{type:"ImageApiSelector",region:"region"in m?m.region:void 0,rotation:"rotation"in m?m.rotation:void 0};throw Error(`Unsupported selector type: ${m["@type"]}`)}(m.selector)}}}(m.on),body:Array.isArray(m.resource)?m.resource.map(upgradeContentResource):upgradeContentResource(m.resource)})}],contentResource:[upgradeContentResource],choice:[function(m){let v=[];return m.default&&"rdf:nil"!==m.default&&v.push(m.default),m.item&&"rdf:nil"!==m.item&&v.push(...m.item),{...technicalProperties$2(m),...descriptiveProperties$2(m),items:v}}],range:[function(m){return removeUndefinedProperties({...technicalProperties$2(m),...descriptiveProperties$2(m),...linkingProperties$2(m),items:m.members})}],service:[function(m){let{"@id":v,"@type":w,"@context":E,profile:C,...S}=m,A={};return v&&(A["@id"]=v),A["@type"]=getNewType(m),"unknown"===A["@type"]&&(E&&E.length&&(A["@context"]=E),A["@type"]="Service"),C&&(A.profile=function getProfile(m){return Array.isArray(m)?getProfile(m.find(m=>"string"==typeof m)):-1!==eV.indexOf(m)?"level2":-1!==eW.indexOf(m)?"level1":"string"==typeof m?m:void 0}(C)),removeUndefinedProperties({...A,...S})}],layer:[function(m){return removeUndefinedProperties({...technicalProperties$2(m),...descriptiveProperties$2(m),...linkingProperties$2(m)})}]});function getResource(m,v){if("string"==typeof m)return{id:m,type:v};if(!m.id)throw Error(`Invalid resource does not have an ID (${v})`);return m}function addMissingIdToContentResource(m){return v=>"string"==typeof v?{id:v,type:m}:v.id?v.type?v:{type:m,...v}:{id:`vault://${function(m){let v=JSON.stringify(m),w=5381,E=v.length;for(;E;)w=33*w^v.charCodeAt(--E);let C=w>>>0,S=C.toString(16);return S.length%2?"0"+S:S}(v)}`,type:m,...v}}function ensureDefaultFields(m){return v=>({...m,...v})}function ensureArray(m){return Array.isArray(m)?m:[m]}function ensureArrayOnAnnotation(m){return m.body&&(m.body=ensureArray(m.body)),m.seeAlso&&(m.seeAlso=ensureArray(m.seeAlso)),m.body&&(m.body=ensureArray(m.body)),m.audience&&(m.audience=ensureArray(m.audience)),m.accessibility&&(m.accessibility=ensureArray(m.accessibility)),m.motivation&&(m.motivation=ensureArray(m.motivation)),m}let eY="__$UNSET$__",eJ="__$UNWRAP$__";function languageString2to3(m){if(!m)return;let v=Object.keys(m);if(0!==v.length){if(1===v.length){let w=v[0];if(!w)return"";let E=(m[w]||[]).join("");return"@none"===w||"none"===w||"en"===w?E:{"@language":w,"@value":E}}return v.map(v=>({"@language":v,"@value":(m[v]||[]).join("")}))}}function unNestArray(m,v=!1){return m?m.length>1&&!v?m:m[0]||void 0:void 0}function convertService(m){if(m){if("string"==typeof m)return{"@id":m};if("@id"in m){let v={...m};return delete v["@type"],v}return{"@context":"http://iiif.io/api/image/2/context.json","@id":m.id,profile:`http://iiif.io/api/image/2/profiles/${m.profile}.json`}}}function technicalProperties$1(m,v){return[["@id",m.id],["@type",v],["format",m.format],["height",m.height],["width",m.width],["viewingDirection","left-to-right"!==m.viewingDirection?m.viewingDirection:void 0]]}function*descriptiveProperties$1(m){let v=m.provider?yield m.provider[0]:void 0;return[["label",languageString2to3(m.label)],["metadata",m.metadata&&m.metadata.length?m.metadata.map(m=>({label:languageString2to3(m.label)||"",value:languageString2to3(m.value)||""})):void 0],["description",languageString2to3(m.summary)],["thumbnail",unNestArray((yield m.thumbnail))],["navDate",m.navDate],["logo",v?unNestArray(v.logo):void 0],["homepage",v?v.homepage:void 0],["attribution",m.requiredStatement?languageString2to3(m.requiredStatement.value):void 0]]}function*linkingProperties$1(m){return[["seeAlso",unNestArray((yield m.seeAlso))],["service",unNestArray((m.service||[]).map(convertService))],["rendering",unNestArray((yield m.rendering))],["startCanvas",m.start?m.start.id:void 0]]}let eK={Manifest:function*(m){return[...technicalProperties$1(m,"sc:Manifest"),...yield*descriptiveProperties$1(m),...yield*linkingProperties$1(m),["sequences",[{"@id":`${m.id}/sequence0`,"@type":"sc:Sequence",canvases:yield m.items}]],["structures",(yield m.structures)]]},Canvas:function*(m){let v=yield m.items,w=v[0];return[...technicalProperties$1(m,"sc:Canvas"),...yield*descriptiveProperties$1(m),...yield*linkingProperties$1(m),["images",w?[w.resources]:void 0],["annotations",m.annotations&&m.annotations.length?unNestArray((yield m.annotations)):void 0]]},AnnotationPage:function*(m){return[...technicalProperties$1(m,"sc:AnnotationList"),...yield*descriptiveProperties$1(m),["resources",m.items&&m.items.length?unNestArray((yield m.items)):void 0]]},Annotation:function*(m){return[["@id",m.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",function parseCanvasTarget(m){return Array.isArray(m)?m.map(m=>parseCanvasTarget(m)):"string"==typeof m?m:m.type&&"Canvas"===m.type?m.id:m}(m.target)],["resource",unNestArray((yield m.body),!0)]]},ContentResource:function*(m){return"Image"===m.type?[...technicalProperties$1(m,"dctypes:Image"),...yield*descriptiveProperties$1(m),...yield*linkingProperties$1(m)]:[...technicalProperties$1(m,void 0),...yield*descriptiveProperties$1(m)]},AnnotationCollection:function*(m){return[["@id",m.id],["@type","sc:Layer"],["label",languageString2to3(m.label)]]},Collection:function*(m){return[...technicalProperties$1(m,"sc:Collection"),...yield*descriptiveProperties$1(m),...yield*linkingProperties$1(m),["members",(yield*m.items)]]},Range:function*(m){let v=[],w=[];if(m.items)for(let E of m.items){let C=yield E;v.push({"@id":E.id,"@type":E.type,label:C?C.label:void 0,within:m.id}),"Canvas"===E.type&&w.push(E.id)}return[...technicalProperties$1(m,"sc:Range"),...yield*descriptiveProperties$1(m),...yield*linkingProperties$1(m),["canvases",w.length===v.length?w:void 0],["members",w.length!==v.length?v:void 0]]}};function technicalProperties(m){var v;return[["id",(null==(v=m.id)?void 0:v.startsWith("vault://"))?void 0:m.id],["type",m.type],["format",m.format],["profile",m.profile],["height",m.height],["width",m.width],["duration",m.duration||void 0],["viewingDirection","left-to-right"!==m.viewingDirection?m.viewingDirection:void 0],["behavior",m.behavior&&m.behavior.length?m.behavior:void 0],["timeMode",m.timeMode],["motivation",Array.isArray(m.motivation)?m.motivation[0]:m.motivation]]}function filterEmpty(m){if(m&&0!==m.length)return m}function service2compat(m){if(m&&m.type&&"ImageService2"===m.type){let{id:v,type:w,profile:E,...C}=m,S="string"==typeof E?E:Array.isArray(E)?E.find(m=>"string"==typeof m):"";return{"@id":v,"@type":w,profile:S?S.startsWith("http")?S:`http://iiif.io/api/image/2/${S}.json`:"http://iiif.io/api/image/2/level0.json",...C}}return m}function filterService2Compat(m){if(m&&0!==m.length)return m.map(service2compat)}function*descriptiveProperties(m){return[["label",m.label],["metadata",filterEmpty(m.metadata)],["summary",m.summary],["requiredStatement",m.requiredStatement],["rights",m.rights],["navDate",m.navDate],["language",m.language],["thumbnail",filterEmpty((yield m.thumbnail))],["placeholderCanvas",(yield m.placeholderCanvas)],["accompanyingCanvas",(yield m.accompanyingCanvas)],["provider",filterEmpty((yield m.provider))]]}function*linkingProperties(m){return[["seeAlso",filterEmpty((yield m.seeAlso))],["service",filterService2Compat(m.service)],["services",filterService2Compat(m.services)],["rendering",filterEmpty((yield m.rendering))],["supplementary",filterEmpty((yield m.supplementary))],["homepage",filterEmpty((yield m.homepage))],["logo",filterEmpty((yield m.logo))],["partOf",filterEmpty((yield m.partOf))],["start",m.start]]}let e0={Manifest:function*(m,v,{isTopLevel:w}){return w?[["@context","http://iiif.io/api/presentation/3/context.json"],...technicalProperties(m),...yield*descriptiveProperties(m),...yield*linkingProperties(m),["items",(yield m.items)],["structures",filterEmpty((yield m.structures))],["annotations",filterEmpty((yield m.annotations))]]:[...technicalProperties(m),...yield*descriptiveProperties(m)]},Canvas:function*(m){return[...technicalProperties(m),...yield*descriptiveProperties(m),...yield*linkingProperties(m),["items",(yield m.items)],["annotations",filterEmpty((yield m.annotations))]]},Agent:function*(m){return[["id",m.id],["type","Agent"],["label",m.label],...yield*linkingProperties(m)]},AnnotationPage:function*(m){let v=Object.entries(m).map(([m,v])=>[m,Array.isArray(v)?filterEmpty(v):v]).filter(([m,v])=>"items"!==m);return[...v,...yield*linkingProperties(m),["items",(yield m.items)]]},Service:function*(m){return[[eJ,service2compat(m)]]},Annotation:function*(m){let v=Object.entries(m).map(([m,v])=>"motivation"===m?[m,Array.isArray(v)?v[0]:v]:[m,Array.isArray(v)?filterEmpty(v):v]).filter(([m])=>"body"!==m),w=yield m.body;return[...v,["body",1===w.length?w[0]:w]]},ContentResource:function*(m){return[...technicalProperties(m),...yield*descriptiveProperties(m),...yield*linkingProperties(m),["annotations",filterEmpty((yield m.annotations))],["items",filterEmpty((yield m.items))]]},AnnotationCollection:function*(m){return[["id",m.id],["type","AnnotationCollection"],["label",m.label]]},Collection:function*(m,v,{isTopLevel:w}){return w?[["@context","http://iiif.io/api/presentation/3/context.json"],...technicalProperties(m),...yield*descriptiveProperties(m),...yield*linkingProperties(m),["items",filterEmpty((yield m.items))]]:[...technicalProperties(m),...yield*descriptiveProperties(m)]},Range:function*(m){let v=[];for(let w of m.items)"Range"===w.type?v.push((yield w)):v.push(w);return[...technicalProperties(m),...yield*descriptiveProperties(m),...yield*linkingProperties(m),["items",v],["annotations",filterEmpty((yield m.annotations))]]}};var e1=w(4887);function _typeof(m){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"==typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(m)}function ownKeys(m,v){var w=Object.keys(m);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(m);v&&(E=E.filter(function(v){return Object.getOwnPropertyDescriptor(m,v).enumerable})),w.push.apply(w,E)}return w}function _objectSpread2(m){for(var v=1;v<arguments.length;v++){var w=null!=arguments[v]?arguments[v]:{};v%2?ownKeys(Object(w),!0).forEach(function(v){!function(m,v,w){var E;E=function(m,v){if("object"!==_typeof(m)||null===m)return m;var w=m[Symbol.toPrimitive];if(void 0!==w){var E=w.call(m,v||"default");if("object"!==_typeof(E))return E;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===v?String:Number)(m)}(v,"string"),(v="symbol"===_typeof(E)?E:String(E))in m?Object.defineProperty(m,v,{value:w,enumerable:!0,configurable:!0,writable:!0}):m[v]=w}(m,v,w[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(w)):ownKeys(Object(w)).forEach(function(v){Object.defineProperty(m,v,Object.getOwnPropertyDescriptor(w,v))})}return m}function formatProdErrorMessage(m){return"Minified Redux error #"+m+"; visit https://redux.js.org/Errors?code="+m+" for the full message or use the non-minified dev environment for full errors. "}var e2="function"==typeof Symbol&&Symbol.observable||"@@observable",randomString=function(){return Math.random().toString(36).substring(7).split("").join(".")},e4={INIT:"@@redux/INIT"+randomString(),REPLACE:"@@redux/REPLACE"+randomString(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+randomString()}};function combineReducers(m){for(var v,w=Object.keys(m),E={},C=0;C<w.length;C++){var S=w[C];"function"==typeof m[S]&&(E[S]=m[S])}var A=Object.keys(E);try{!function(m){Object.keys(m).forEach(function(v){var w=m[v];if(void 0===w(void 0,{type:e4.INIT}))throw Error(formatProdErrorMessage(12));if(void 0===w(void 0,{type:e4.PROBE_UNKNOWN_ACTION()}))throw Error(formatProdErrorMessage(13))})}(E)}catch(m){v=m}return function(m,w){if(void 0===m&&(m={}),v)throw v;for(var C=!1,S={},_=0;_<A.length;_++){var k=A[_],I=E[k],P=m[k],T=I(P,w);if(void 0===T)throw w&&w.type,Error(formatProdErrorMessage(14));S[k]=T,C=C||T!==P}return(C=C||A.length!==Object.keys(m).length)?S:m}}function compose(){for(var m=arguments.length,v=Array(m),w=0;w<m;w++)v[w]=arguments[w];return 0===v.length?function(m){return m}:1===v.length?v[0]:v.reduce(function(m,v){return function(){return m(v.apply(void 0,arguments))}})}function applyMiddleware(){for(var m=arguments.length,v=Array(m),w=0;w<m;w++)v[w]=arguments[w];return function(m){return function(){var w=m.apply(void 0,arguments),_dispatch=function(){throw Error(formatProdErrorMessage(15))},E={getState:w.getState,dispatch:function(){return _dispatch.apply(void 0,arguments)}},C=v.map(function(m){return m(E)});return _dispatch=compose.apply(void 0,C)(w.dispatch),_objectSpread2(_objectSpread2({},w),{},{dispatch:_dispatch})}}}let e3="@iiif/IMPORT_ENTITIES",e6="@iiif/MODIFY_ENTITY_FIELD",e5="@iiif/REORDER_ENTITY_FIELD",e8="@iiif/ADD_REFERENCE",e9="@iiif/REMOVE_REFERENCE",e7=(0,e1.createAction)(e3)(),tt=(0,e1.createAction)(e6)(),ti=(0,e1.createAction)(e5)(),tn=(0,e1.createAction)(e8)(),ta=(0,e1.createAction)(e9)(),to={importEntities:e7,modifyEntityField:tt,reorderEntityField:ti,addReference:tn,removeReference:ta},tl="@iiif/ADD_MAPPING",ts="@iiif/ADD_MAPPINGS",tc=(0,e1.createAction)(tl)(),td=(0,e1.createAction)(ts)(),tu="@iiif/SET_META_VALUE",tp="@iiif/SET_META_VALUE_DYNAMIC",tm="@iiif/UNSET_META_VALUE",th=(0,e1.createAction)(tu)(),tf=(0,e1.createAction)(tp)(),tg=(0,e1.createAction)(tm)(),tv={setMetaValue:th,setMetaValueDynamic:tf,unsetMetaValue:tg},ty="RESOURCE_ERROR",tw="RESOURCE_LOADING",tb="RESOURCE_READY",tx="@iiif/REQUEST_RESOURCE",tE="@iiif/REQUEST_ERROR",tC="@iiif/REQUEST_MISMATCH",tS="@iiif/REQUEST_COMPLETE",tA="@iiif/REQUEST_OFFLINE_RESOURCE",t_=(0,e1.createAction)(tx)(),tk=(0,e1.createAction)(tE)(),tI=(0,e1.createAction)(tC)(),t$=(0,e1.createAction)(tS)();(0,e1.createAction)(tA)();let tP="@iiif/BATCH",tT="@iiif/BATCH_IMPORT",tR=(0,e1.createAction)(tP)();(0,e1.createAction)(tT)();let actionListFromResource=(m,v)=>{let{entities:w,resource:E,mapping:C}=function(m){let v=m&&m["@context"]&&("http://iiif.io/api/presentation/2/context.json"===m["@context"]||-1!==m["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")||"http://www.shared-canvas.org/ns/context.json"===m["@context"])||"http://iiif.io/api/image/2/context.json"===m["@context"]?eQ.traverseUnknown(m):m,w={Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}},E={},addToEntities=(m,v)=>{let E=w[m]?w[m]:{};return w=>{let C=getResource(w,v||m);return C&&C.id&&m?(E[C.id]=E[C.id]?function(m,v){if("string"==typeof m)return m;if(v.id!==m.id||v.type!==m.type)throw Error("Can only merge entities with identical identifiers and type!");return function merge(m,v){if(!v)return m;if(Array.isArray(m)){if(!Array.isArray(v))throw Error("Cannot merge array with non-array");let w=[...m];for(let E of v)if(null!=E){if(Array.isArray(E))w.push(E);else if("object"==typeof E&&E.id&&E.type){let m=w.findIndex(m=>m.id===E.id&&m.type===E.type);m>=0&&(w[m]=merge(w[m],E))}else -1===m.indexOf(E)&&w.push(E)}return w}if("object"==typeof m){if(Array.isArray(v)||"object"!=typeof v)throw Error("Cannot merge object with non-object");let w={...m};for(let[m,E]of Object.entries(v)){let v=w[m];v!==eh&&v?w[m]=merge(v,E):w[m]=E}return w}return m||v}({...m},v)}(E[C.id],C):Object.assign({},C),{id:C.id,type:"ContentResource"===m?m:C.type}):C}},addToMapping=(m,v)=>w=>{let{id:C,type:S}=getResource(w,v||m);if(void 0===C)throw Error("Found invalid entity without an ID.");return"ContentResource"===m?E[C]=m:E[C]=S,w},C=new Traverse$1({collection:[ensureDefaultFields(ev),addToMapping("Collection"),addToEntities("Collection")],manifest:[ensureDefaultFields(ey),addToMapping("Manifest"),addToEntities("Manifest")],canvas:[ensureDefaultFields(eg),addToMapping("Canvas"),addToEntities("Canvas")],annotationPage:[addMissingIdToContentResource("AnnotationPage"),ensureDefaultFields(ef),addToMapping("AnnotationPage"),addToEntities("AnnotationPage")],annotation:[addMissingIdToContentResource("Annotation"),ensureArrayOnAnnotation,addToMapping("Annotation"),addToEntities("Annotation")],contentResource:[addMissingIdToContentResource("ContentResource"),addToMapping("ContentResource"),addToEntities("ContentResource")],range:[ensureDefaultFields(ew),addToMapping("Range","Canvas"),addToEntities("Range","Canvas")],agent:[ensureDefaultFields(eb),addToMapping("Agent"),addToEntities("Agent")]}),S=C.traverseUnknown(v);return{entities:w,resource:S,mapping:E}}(v);if(void 0===E.id)return[tk({id:m,message:"ID is not defined in resource."})];let S=[e7({entities:w}),td({mapping:C})];return E.id!==m&&(S.push(tc({id:m,type:E.type})),S.push(tI({requestId:m,actualId:E.id}))),S.push(t$({id:m})),S},tO=Number.isNaN||function(m){return"number"==typeof m&&m!=m};function areInputsEqual(m,v){if(!Array.isArray(m)||!Array.isArray(v))return m===v;if(m.length!==v.length)return!1;for(let C=0;C<m.length;C++){var w,E;if(!((w=m[C])===(E=v[C])||tO(w)&&tO(E)))return!1}return!0}function esm_resolveIfExists(m,v){let w=m.iiif.requests[v],E=m.iiif.mapping[v];if(E&&m.iiif.entities[E][w.resourceUri])return m.iiif.entities[E][w.resourceUri]}function createFetchHelper(m,v,{waitTimeout:w=30}={}){return async(E,C)=>{let S=m.getState(),A=S.iiif.requests[E];if(A)switch(A.loadingState){case ty:break;case tw:{let v;let C=!1;try{let S=await Promise.race([new Promise((w,S)=>{C||(v=m.subscribe(()=>{let v=m.getState();if(v.iiif.requests[E].loadingState===ty){S();return}if(v.iiif.requests[E].loadingState===tb){let m=esm_resolveIfExists(v,E);m?w(m):S()}}))}),new Promise((m,v)=>setTimeout(()=>{C=!0,v()},60*w))]);if(v&&v(),S)return S}catch(m){v&&v()}break}case tb:{let m=esm_resolveIfExists(S,E);if(m)return m}}m.dispatch(t_({id:E}));try{let w=await v(E,C);w.id||w["@id"]||(w["@type"]&&(w["@id"]=E),w.id=E);let S=actionListFromResource(E,w);return m.dispatch(tR({actions:S})),esm_resolveIfExists(m.getState(),E)}catch(v){throw m.dispatch(tk({id:E,message:v.toString()})),v}}}function esm_getDefaultEntities(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function isReferenceList(m,v,w,E){return!(!m[w]||!m[w][v]||!m[w][v][E]||!Array.isArray(m[w][v][E]))}let tM=combineReducers({mapping:(m={},v)=>{switch(v.type){case tl:return{...m,[v.payload.id]:v.payload.type};case ts:return{...m,...v.payload.mapping};default:return m}},entities:(m=esm_getDefaultEntities(),v)=>{switch(v.type){case e6:{if(!m[v.payload.type]||!m[v.payload.type][v.payload.id])return m;let w=m[v.payload.type][v.payload.id];if("string"==typeof w)return m;return{...m,[v.payload.type]:{...m[v.payload.type],[v.payload.id]:{...w,[v.payload.key]:v.payload.value}}}}case e5:{if(!isReferenceList(m,v.payload.id,v.payload.type,v.payload.key))return m;let w=m[v.payload.type][v.payload.id];if("string"==typeof w)return m;let E=Array.from(w[v.payload.key]),[C]=E.splice(v.payload.startIndex,1);return E.splice(v.payload.endIndex,0,C),{...m,[v.payload.type]:{...m[v.payload.type],[v.payload.id]:{...w,[v.payload.key]:E}}}}case e3:{let w=Object.keys(v.payload.entities),E={...m};for(let C of w){let w=v.payload.entities[C],S={...m[C]||{}},A=!1,_=Object.keys(w||{})||[];if(w&&_){for(let v of _)A=!0,S[v]=m[C][v]?function(m,v){let w={},E=[];for(let[C,S]of Object.entries(m||{})){E.push(C);let m=(v||{})[C];if(!m||0===m.length){w[C]=S;continue}w[C]=m}for(let[m,C]of Object.entries(v||{}))-1===E.indexOf(m)&&(w[m]=C);return w}(m[C][v],w[v]):w[v];A&&(E[C]=S)}}return E}case e8:{if(!isReferenceList(m,v.payload.id,v.payload.type,v.payload.key))return m;let w=m[v.payload.type][v.payload.id],E=Array.from(w[v.payload.key]);return E.splice(v.payload.index||E.length+1,0,v.payload.reference),{...m,[v.payload.type]:{...m[v.payload.type],[v.payload.id]:{...w,[v.payload.key]:E}}}}case e9:{if(!isReferenceList(m,v.payload.id,v.payload.type,v.payload.key))return m;let w=m[v.payload.type][v.payload.id],E=Array.from(w[v.payload.key]),C=v.payload.index||E.findIndex(m=>m&&m.id===v.payload.reference.id);if(-1===C||E[C]?.id!==v.payload.reference.id)return m;return E.splice(C,1),{...m,[v.payload.type]:{...m[v.payload.type],[v.payload.id]:{...w,[v.payload.key]:E}}}}default:return m}},requests:(m={},v)=>{switch(v.type){case tx:case tA:return{...m,[v.payload.id]:{requestUri:v.payload.id,loadingState:tw,uriMismatch:!1,resourceUri:v.payload.id}};case tC:return{...m,[v.payload.requestId]:{...m[v.payload.requestId]||{},uriMismatch:!0,resourceUri:v.payload.actualId},[v.payload.actualId]:{requestUri:v.payload.requestId,loadingState:m[v.payload.requestId].loadingState,uriMismatch:!0,resourceUri:v.payload.actualId}};case tE:return{...m,[v.payload.id]:{...m[v.payload.id]||{},loadingState:ty,error:v.payload.message}};case tS:return{...m,[v.payload.id]:{...m[v.payload.id]||{},loadingState:tb,error:void 0}}}return m},meta:(m={},v)=>{let{id:w,updateValue:E,value:C,meta:S,key:A}=v&&v.payload||{};switch(v.type){case tu:return{...m,[w]:{...m[w]||{},[S]:{...m[w]&&m[w][S]||{},[A]:C}}};case tp:return{...m,[w]:{...m[w]||{},[S]:{...m[w]&&m[w][S]||{},[A]:E(m[w]&&m[w][S]?m[w][S][A]:void 0)}}};case tm:if(m[w]&&m[w][S]&&m[w][S][A])return{...m,[w]:{...m[w]||{},[S]:{...m[w]&&m[w][S]||{},[A]:void 0}}};return m;default:return m}}}),tz="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||compose;let Vault=class Vault{options;store;emitter;isBatching=!1;batchQueue=[];remoteFetcher;staticFetcher;constructor(m,v){var w;this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},m||{}),this.store=v||function(m={}){let{enableDevtools:v=!0,iiifStoreName:w="iiif",defaultState:E={},extraMiddleware:C=[],customReducers:S={}}=m,A=combineReducers({[w]:tM,...S}),_=function createStore(m,v,w){if("function"==typeof v&&"function"==typeof w||"function"==typeof w&&"function"==typeof arguments[3])throw Error(formatProdErrorMessage(0));if("function"==typeof v&&void 0===w&&(w=v,v=void 0),void 0!==w){if("function"!=typeof w)throw Error(formatProdErrorMessage(1));return w(createStore)(m,v)}if("function"!=typeof m)throw Error(formatProdErrorMessage(2));var E,C=m,S=v,A=[],_=A,k=!1;function ensureCanMutateNextListeners(){_===A&&(_=A.slice())}function getState(){if(k)throw Error(formatProdErrorMessage(3));return S}function subscribe(m){if("function"!=typeof m)throw Error(formatProdErrorMessage(4));if(k)throw Error(formatProdErrorMessage(5));var v=!0;return ensureCanMutateNextListeners(),_.push(m),function(){if(v){if(k)throw Error(formatProdErrorMessage(6));v=!1,ensureCanMutateNextListeners();var w=_.indexOf(m);_.splice(w,1),A=null}}}function dispatch(m){if(!function(m){if("object"!=typeof m||null===m)return!1;for(var v=m;null!==Object.getPrototypeOf(v);)v=Object.getPrototypeOf(v);return Object.getPrototypeOf(m)===v}(m))throw Error(formatProdErrorMessage(7));if(void 0===m.type)throw Error(formatProdErrorMessage(8));if(k)throw Error(formatProdErrorMessage(9));try{k=!0,S=C(S,m)}finally{k=!1}for(var v=A=_,w=0;w<v.length;w++)(0,v[w])();return m}return dispatch({type:e4.INIT}),(E={dispatch:dispatch,subscribe:subscribe,getState:getState,replaceReducer:function(m){if("function"!=typeof m)throw Error(formatProdErrorMessage(10));C=m,dispatch({type:e4.REPLACE})}})[e2]=function(){var m;return(m={subscribe:function(m){if("object"!=typeof m||null===m)throw Error(formatProdErrorMessage(11));function observeState(){m.next&&m.next(getState())}return observeState(),{unsubscribe:subscribe(observeState)}}})[e2]=function(){return this},m},E}((m,v)=>v&&v.type===tP?v.payload.actions.reduce(A,m):v&&v.type===tT?v.payload.state:A(m,v),E,v?tz(applyMiddleware(...C)):compose(applyMiddleware(...C)));return _}({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter={all:w=w||new Map,on:function(m,v){var E=w.get(m);E?E.push(v):w.set(m,[v])},off:function(m,v){var E=w.get(m);E&&(v?E.splice(E.indexOf(v)>>>0,1):w.set(m,[]))},emit:function(m,v){var E=w.get(m);E&&E.slice().map(function(m){m(v)}),(E=w.get("*"))&&E.slice().map(function(w){w(m,v)})}},this.remoteFetcher=createFetchHelper(this.store,this.options.customFetcher),this.staticFetcher=createFetchHelper(this.store,(m,v)=>v)}defaultFetcher=m=>fetch(m).then(m=>m.json());batch(m){this.isBatching=!0;try{m(this),this.store.dispatch(tR({actions:this.batchQueue}))}catch(m){throw this.batchQueue=[],this.isBatching=!1,m}this.batchQueue=[],this.isBatching=!1}async asyncBatch(m){this.isBatching=!0;try{await m(this),this.store.dispatch(tR({actions:this.batchQueue}))}catch(m){throw this.batchQueue=[],this.isBatching=!1,m}this.batchQueue=[],this.isBatching=!1}modifyEntityField(m,v,w){this.dispatch(to.modifyEntityField({id:m.id,type:m.type,key:v,value:w}))}dispatch(m){this.isBatching?this.batchQueue.push(m):this.store.dispatch(m)}middleware=m=>v=>w=>{if(w.type===tP){for(let v of w.payload.actions)this.emitter.emit(v.type,{realAction:v,state:m.getState()});let E=v(w);for(let m of w.payload.actions)this.emitter.emit(`after:${w.type}`,{action:w,state:E});return E}this.emitter.emit(w.type,{action:w,state:m.getState()});let E=v(w);return this.emitter.emit(`after:${w.type}`,{action:w,state:E}),E};serialize(m,v){return function(m,v,w){if(!v.type||!v.id)throw Error("Unknown entity");if(!w[v.type])throw Error(`Serializer not found for ${v.type}`);return function flatten(E){let C=w[E.type];if(!C)return eY;let S=function(m,v){let w=m.requests[v],E=m.mapping[v];if(E&&(!w||!w.resourceUri||m.entities[E][w.resourceUri]))return m.entities[E][w?w.resourceUri:v]}(m,E.id)||(E.id&&E.type?E:null);if(!S)return eY;let A=C(S,m,{isTopLevel:v.id===E.id}),_=A.next();for(;!_.done;){let m=_.value,v=eY;if(m){if(Array.isArray(m)){let w=[];for(let v of m)w.push(flatten(v));v=w}else v=flatten(m)}_=A.next(v)}return _.value===eY?eY:function(m){let v={};for(let[w,E]of m){if(w===eJ&&E!==eY)return E;E!==eY&&null!=E&&(v[w]=E)}return v}(_.value)}(v)}(this.getState().iiif,m,v)}toPresentation2(m){return this.serialize(m,eK)}toPresentation3(m){return this.serialize(m,e0)}hydrate(m,v){return this.get(m,v,{skipSelfReturn:!1})}get(m,v,w={}){"string"!=typeof v&&(w=v||{},v=void 0);let{skipSelfReturn:E=!0}=w||{};if(Array.isArray(m))return m.map(m=>this.get(m,w));let C=this.getState();if("string"==typeof m){let w=v||C.iiif.mapping[m];if(!w)return E?null:{id:m,type:"unknown"};m={id:m,type:w}}let S=v||m.type,A=m.id,_=C.iiif.entities[S];if(!_){let v=C.iiif.requests[A];return v&&v.resourceUri!==A?this.get(v.resourceUri,w):E?null:m}return _[m.id]||(E?null:m)}select(m){return m(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(m,v){let w="string"==typeof m?m:m.id;return this.load(w,v)}loadCollection(m,v){let w="string"==typeof m?m:m.id;return this.load(w,v)}load(m,v){let w="string"==typeof m?m:m.id;return v?this.staticFetcher(w,v):this.remoteFetcher(w)}areInputsEqual(m,v){return areInputsEqual(m,v)}subscribe(m,v,w){void 0===w&&(void 0===v||!1===v||!0===v)&&(w=v,v=m,m=m=>m);let E=w?null:m(this.store.getState());return w||v(E,this),this.store.subscribe(()=>{let w=this.store.getState(),C=m(w);E===C||areInputsEqual(E,C)||v(C,this),E=C})}async ensureLoaded(m){let v="string"==typeof m?m:m.id;this.requestStatus(v)||await this.load(v)}requestStatus(m){return this.select(v=>v.iiif.requests[m])}getResourceMeta(m,v){let w=this.getState().iiif.meta[m];return w?v?w[v]:w:void 0}setMetaValue([m,v,w],E){this.dispatch("function"==typeof E?tv.setMetaValueDynamic({id:m,meta:v,key:w,updateValue:E}):tv.setMetaValue({id:m,meta:v,key:w,value:E}))}};var tL=w(1036),tj=w(3041),tF=w(4921);let tH={annotations:[],manifest:void 0,searchString:void 0,options:{offset:0},vault:new Vault};function ee(m,v){switch(v.type){case"updateAnnotations":return{...m,annotations:v.payload};case"updateSearchString":return{...m,searchString:v.payload};default:return m}}let tN=(0,O.createContext)({dispatch:()=>null,state:tH}),te=m=>{let{children:v,manifest:w}=m,E={...tH.options,...m.options},[C,S]=(0,O.useReducer)(ee,tH);return O.createElement(tN.Provider,{value:{state:{...C,manifest:w,options:E},dispatch:S}},v)},re=(m,v="none")=>{if(!m)return null;if("string"==typeof m)return[m];if(!m[v]){let v=Object.getOwnPropertyNames(m);if(v.length>0)return m[v[0]]}return m[v]&&Array.isArray(m[v])?m[v]:null},scroll_B=(m,v="none",w=", ")=>{let E=re(m,v);return Array.isArray(E)?E.join(`${w}`):E};function scroll_A(m,v){let w=Object.keys(m).filter(m=>v.includes(m)?null:m),E={};return w.forEach(v=>{E[v]=m[v]}),E}let{styled:tB,css:tD,keyframes:tW,createTheme:tV}=(0,R.Th)({theme:{colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"hsl(209 100% 38.2%)",accentMuted:"hsl(209 80% 61.8%)",accentAlt:"hsl(209 80% 30%)",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},media:{xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"}}),tU=tB("span",{}),scroll_F=m=>{let{as:v,label:w}=m,E=scroll_A(m,["as","label"]);return O.createElement(tU,{as:v,...E},scroll_B(w,E.lang))};tB("img",{objectFit:"cover"}),tB("a",{});let tq={delimiter:", "},tG=(0,O.createContext)(void 0),ce=()=>{let m=(0,O.useContext)(tG);if(void 0===m)throw Error("usePrimitivesContext must be used with a PrimitivesProvider");return m},de=({children:m,initialState:v=tq})=>{let w=me(v,"delimiter");return O.createElement(tG.Provider,{value:{delimiter:w}},m)},me=(m,v)=>Object.hasOwn(m,v)?m[v].toString():void 0,tZ=tB("span",{}),scroll_H=m=>{let{as:v,markup:w}=m,{delimiter:E}=ce();if(!w)return O.createElement(O.Fragment,null);let C=scroll_A(m,["as","markup"]),S={__html:tL(scroll_B(w,C.lang,E),{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})};return O.createElement(tZ,{as:v,...C,dangerouslySetInnerHTML:S})},pe=m=>O.useContext(tG)?O.createElement(scroll_H,{...m}):O.createElement(de,null,O.createElement(scroll_H,{...m}));tB("span",{}),tB("dl",{}),tB("li",{}),tB("ul",{}),tB("li",{}),tB("ul",{}),tB("dl",{}),tB("li",{}),tB("ul",{});let he=m=>{let{as:v,summary:w}=m,E=scroll_A(m,["as","customValueDelimiter","summary"]);return O.createElement(pe,{as:v,markup:w,...E})},tX=tB("div",{display:"flex",flexDirection:"column",justifyContent:"space-between"}),tQ=tB("aside",{margin:"0",padding:"0",position:"relative",zIndex:2,flexGrow:"1",flexShrink:"0",[`& ${tX}`]:{position:"absolute",width:"50%",top:0},"&.anchor":{[`& ${tX}`]:{position:"fixed",width:"50%"}}}),tY=tB("header",{display:"flex",justifyContent:"space-between",fontSize:"1",flexGrow:"1",flexShrink:"0",marginBottom:"1.618rem",strong:{fontWeight:"400",fontSize:"1.33rem"}}),tJ=tB("section",{margin:"0",gap:"1rem"}),ve=({label:m})=>O.createElement(tY,null,O.createElement("strong",null,O.createElement(scroll_F,{label:m}))),tK=tB("article",{transition:"all 0.382s ease-in-out",display:"flex",flexDirection:"row",flexWrap:"nowrap",gap:"2.618rem"}),t0=tB("div",{transition:"$all",width:"50%",opacity:0,transform:"translateX(2.618rem)",zIndex:-1}),t1=tB("div",{width:"50%",display:"flex",flexDirection:"column",justifyContent:"flex-start"}),t2=tB("hr",{margin:"0",borderColor:"transparent",height:"1.618rem",position:"relative",zIndex:0,display:"flex",justifyContent:"flex-end",marginTop:"2.618rem","&::before":{content:"attr(aria-label)",position:"absolute",right:"1.618rem",bottom:"0",zIndex:1,display:"flex",fontSize:"0.7222rem",fontWeight:"400",lineHeight:"1rem",background:"inherit",opacity:.7},"&::after":{content:"",width:"100%",position:"absolute",zIndex:0,height:"1px",background:"#6662"}}),t4=tB("div",{position:"relative",zIndex:"1",display:"flex",flexDirection:"column",gap:"2.618rem","&[data-figures-visible='true']":{[`& ${t0}`]:{opacity:1,zIndex:0,transform:"translateX(0)"}}}),Se=({canvas:m,canvasInfo:{current:v,total:w}})=>O.createElement("figcaption",null,O.createElement("em",null,v," / ",w),(null==m?void 0:m.label)&&O.createElement(scroll_F,{label:null==m?void 0:m.label}),(null==m?void 0:m.summary)&&O.createElement(he,{summary:null==m?void 0:m.summary,as:"p"})),t3=window.OpenSeadragon;if(!t3&&!(t3=P))throw Error("OpenSeadragon is missing.");let t6="http://www.w3.org/2000/svg";t3.Viewer&&(t3.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo||(this._svgOverlayInfo=new scroll_N(this)),this._svgOverlayInfo});let scroll_N=function(m){let v=this;this._viewer=m,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(t6,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(t6,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){v.resize()}),this._viewer.addHandler("open",function(){v.resize()}),this._viewer.addHandler("rotate",function(){v.resize()}),this._viewer.addHandler("flip",function(){v.resize()}),this._viewer.addHandler("resize",function(){v.resize()}),this.resize()};scroll_N.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));let m=this._viewer.viewport.pixelFromPoint(new t3.Point(0,0),!0),v=this._viewer.viewport.getZoom(!0),w=this._viewer.viewport.getRotation(),E=this._viewer.viewport.getFlip(),C=this._viewer.viewport._containerInnerSize.x,S=C*v,A=S;E&&(S=-S,m.x=-m.x+C),this._node.setAttribute("transform","translate("+m.x+","+m.y+") scale("+S+","+A+") rotate("+w+")")},onClick:function(m,v){new t3.MouseTracker({element:m,clickHandler:v}).setTracking(!0)}};let Ie=m=>fetch(`${m.replace(/\/$/,"")}/info.json`).then(m=>m.json()).then(m=>m).catch(v=>{console.error(`The IIIF tilesource ${m.replace(/\/$/,"")}/info.json failed to load: ${v}`)}),ke=m=>{let v,w;return Array.isArray(m)&&(v=m[0])&&(w="@id"in v?v["@id"]:v.id),w};var t5=((S=t5||{}).TiledImage="tiledImage",S.SimpleImage="simpleImage",S);let Ce=m=>{let v=Array.isArray(null==m?void 0:m.service)&&(null==m?void 0:m.service.length)>0,w=v?ke(null==m?void 0:m.service):null==m?void 0:m.id,E=v?t5.TiledImage:t5.SimpleImage;return{uri:w,imageType:E}},$e=(m,v)=>{let w=v?t5.TiledImage:t5.SimpleImage;return{uri:m,imageType:w}},t8=tB("div",{display:"flex",flexDirection:"column",alignItems:"center"}),t9=tB("p",{fontWeight:"bold",fontSize:"x-large"}),t7=tB("span",{fontSize:"medium"}),Be=({error:m})=>{let{message:v}=m;return O.createElement(t8,{role:"alert"},O.createElement(t9,{"data-testid":"headline"},"Something went wrong"),v&&O.createElement(t7,null,`Error message: ${v}`," "))},rt=tB("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),rr=tB("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),rn=tB("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${rt}`]:{display:"block"}},false:{[`${rt}`]:{display:"none"}}}}}),ra=tB("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),scroll_b=({className:m,id:v,label:w,children:E})=>{let C=w.toLowerCase().replace(/\s/g,"-");return O.createElement(ra,{id:v,className:m,"data-testid":"openseadragon-button","data-button":C},O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${v}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},O.createElement("title",{id:`${v}-svg-title`},w),E))},ro=tB("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),Pe=()=>O.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),Te=()=>O.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),We=()=>O.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),Re=()=>O.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),scroll_T=()=>O.createElement(O.Fragment,null,O.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),O.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),Oe=({_cloverViewerHasPlaceholder:m,config:v})=>O.createElement(ro,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:m},v.showZoomControl&&O.createElement(O.Fragment,null,O.createElement(scroll_b,{id:v.zoomInButton,label:"zoom in"},O.createElement(Pe,null)),O.createElement(scroll_b,{id:v.zoomOutButton,label:"zoom out"},O.createElement(Te,null))),v.showFullPageControl&&O.createElement(scroll_b,{id:v.fullPageButton,label:"full page"},O.createElement(We,null)),v.showRotationControl&&O.createElement(O.Fragment,null,O.createElement(scroll_b,{id:v.rotateRightButton,label:"rotate right"},O.createElement(scroll_T,null)),O.createElement(scroll_b,{id:v.rotateLeftButton,label:"rotate left"},O.createElement(scroll_T,null))),v.showHomeControl&&O.createElement(scroll_b,{id:v.homeButton,label:"reset"},O.createElement(Re,null))),De=({ariaLabel:m,config:v,uri:w,_cloverViewerHasPlaceholder:E,imageType:C,openSeadragonCallback:S})=>{let[A,_]=(0,O.useState)(),[k,I]=(0,O.useState)();return(0,O.useEffect)(()=>(k||I(P(v)),()=>null==k?void 0:k.destroy()),[]),(0,O.useEffect)(()=>{k&&S&&S(k)},[k,S]),(0,O.useEffect)(()=>{w!==A&&_(w)},[A,w]),(0,O.useEffect)(()=>{if(A&&k)switch(C){case"simpleImage":k.addSimpleImage({url:A});break;case"tiledImage":Ie(A).then(m=>{try{if(!m)throw Error(`No tile source found for ${A}`);k.addTiledImage({tileSource:m})}catch(m){console.error(m)}});break;default:k.close(),console.warn(`Unable to render ${A} in OpenSeadragon as type: "${C}"`)}},[C,A,k]),O.createElement(rn,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":v.id,hasNavigator:v.showNavigator},O.createElement(Oe,{_cloverViewerHasPlaceholder:E,config:v}),v.showNavigator&&O.createElement(rt,{id:v.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),O.createElement(rr,{id:v.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...m&&{"aria-label":m}}))},Ve=({_cloverViewerHasPlaceholder:m=!1,body:v,instanceId:w,isTiledImage:E=!1,label:C,src:S="",openSeadragonCallback:A,openSeadragonConfig:_={}})=>{let k=w||esm_browser_v4(),I="string"==typeof C?C:scroll_B(C),P={id:`openseadragon-${k}`,navigatorId:`openseadragon-navigator-${k}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${k}`,homeButton:`reset-${k}`,rotateLeftButton:`rotateLeft-${k}`,rotateRightButton:`rotateRight-${k}`,zoomInButton:`zoomIn-${k}`,zoomOutButton:`zoomOut-${k}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1},..._},{imageType:R,uri:z}=v?Ce(v):$e(S,E);return z?O.createElement(T.SV,{FallbackComponent:Be},O.createElement(De,{_cloverViewerHasPlaceholder:m,ariaLabel:I,config:P,imageType:R,key:k,uri:z,openSeadragonCallback:A})):null},rl=tB("div",{width:"100%",height:"400px",background:"#6662",backgroundSize:"contain",color:"white",position:"relative",zIndex:"1",overflow:"hidden"}),Ze=({body:m,label:v})=>O.createElement(rl,{"data-testid":"scroll-figure-image"},O.createElement(Ve,{body:m,openSeadragonConfig:{showNavigator:!1,showHomeControl:!1},...v&&{label:v}})),rs=tB("figure",{figcaption:{display:"flex",flexDirection:"column",margin:"1.618rem 0 0",opacity:.9,em:{fontSize:"0.9em",fontStyle:"normal",opacity:.7}}}),Ue=(m,v,w,E)=>{var C,S;let A={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]};if(A.canvas=m.get(v),A.canvas&&(A.annotationPage=m.get(A.canvas.items[0]),A.accompanyingCanvas=null!=(C=A.canvas)&&C.accompanyingCanvas?m.get(null==(S=A.canvas)?void 0:S.accompanyingCanvas):void 0),A.annotationPage){let C=m.get(A.annotationPage.items).map(v=>({body:m.get(v.body[0].id),motivation:v.motivation,type:"Annotation"})),S=[];C.forEach(v=>{"Choice"===v.body.type?v.body.items.forEach(w=>S.push({...v,id:w.id,body:m.get(w.id)})):S.push(v)}),A.annotations=S.filter(C=>{if(C){if(!C.body||!C.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",C);return}let S=C.body;Array.isArray(S)&&(S=S[0]);let A=m.get(S.id);if(A)switch(w){case"painting":return C.target===v.id&&C.motivation&&"painting"===C.motivation[0]&&E.includes(A.type)&&(C.body=A),!!C;case"supplementing":return;default:throw Error("Invalid annotation motivation.")}}})}return A},Ge=(m,v)=>{let w=Ue(m,{id:v,type:"Canvas"},"painting",["Image","Sound","Video"]);if(0!==w.annotations.length&&w.annotations&&w.annotations)return w.annotations.map(m=>null==m?void 0:m.body)},qe=({canvas:m,canvasInfo:v})=>{let{state:w}=(0,O.useContext)(tN),{vault:E}=w,C=Ge(E,m.id);return C?O.createElement(rs,null,null==C?void 0:C.map(v=>O.createElement(Ze,{body:v,key:null==v?void 0:v.id,label:null==m?void 0:m.label})),O.createElement(Se,{canvas:m,canvasInfo:v})):null},rc="255, 197, 32",rd=tB("div",{paddingTop:"1.618rem","span.highlight":{position:"relative",fontWeight:"bold","&::before":{top:"0",position:"absolute",display:"inline",content:"",width:"calc(100% + 4px)",height:"calc(100% + 2px) ",marginLeft:"-2px",borderRadius:"3px",border:`1px solid rgba(${rc}, 0.2)`,borderBottom:`1px solid rgba(${rc}, 0.618)`,boxShadow:"1px 1px 1px #6661"},"&::after":{left:"0",top:"0",position:"absolute",display:"inline",content:"",width:"calc(100% + 4px)",height:"calc(100% + 2px) ",marginLeft:"-2px",marginTop:"-1px",borderRadius:"3px",backgroundColor:`rgba(${rc}, 0.2)`,zIndex:-1}}}),Ye=({body:m})=>{let[v,w]=(0,O.useState)(""),{state:E}=(0,O.useContext)(tN),{searchString:C}=E;return(0,O.useEffect)(()=>{let v=null==m?void 0:m.value;if((null==m?void 0:m.format)==="text/plain"&&(v=null==v?void 0:v.replace(/\n/g,"<br />")),C){let m=RegExp(C,"gi");v=null==v?void 0:v.replace(m,m=>`<span class="highlight">${m}</span>`)}w(v)},[m,C]),v?O.createElement(rd,{dangerouslySetInnerHTML:{__html:v},"data-body-id":m.id,"data-testid":"scroll-item-body",id:m.id}):null},ru=O.memo(({hasItemBreak:m,isLastItem:v,item:w,itemCount:E,itemNumber:C})=>{var S;let{state:A}=O.useContext(tN),{annotations:_,vault:k}=A,I=null==k?void 0:k.get(w),P=null==(S=null==_?void 0:_.filter(m=>m.target===w.id))?void 0:S.map(m=>{var v;return null==(v=null==m?void 0:m.body)?void 0:v.map((m,v)=>O.createElement(Ye,{body:m,key:v}))}),T={current:C,total:E};return O.createElement(tK,{"data-page-break":m,"data-page-number":C,"data-last-item":v},O.createElement(t0,null,I&&O.createElement(qe,{canvas:I,canvasInfo:T})),O.createElement(t1,null,(null==I?void 0:I.label)&&O.createElement("strong",null,O.createElement(scroll_F,{label:null==I?void 0:I.label})," ",`(${T.current} / ${T.total})`),O.createElement("div",null,P||O.createElement("p",null,"[Blank]")),m&&O.createElement(t2,{"aria-label":"Page Break"})))}),rp="255, 197, 32",rm=tB("span",{fontWeight:"700"}),rh=tB("div",{display:"flex",gap:"0.25rem"}),rf=tB("div",{display:"flex",flexDirection:"column",gap:"0.5rem",button:{backgroundColor:"#6660",opacity:"0.7",transition:"$all",padding:"0.5rem 0.618rem",fontSize:"0.9rem",lineHeight:"1.1rem",textAlign:"left",borderRadius:"6px",border:"1px solid #6662",borderBottomWidth:"2px",display:"flex",flexDirection:"column",gap:"0.25rem","&:hover":{opacity:"1",boxShadow:"5px 5px 13px #6662"},"&[data-result=true]":{backgroundColor:`rgba(${rp}, 0.2)`,borderColor:`rgba(${rp}, 0.2)`,borderBottomColor:`rgba(${rp}, 0.382)`,opacity:"1","&:hover":{backgroundColor:`rgba(${rp}, 0.382)`}}}}),rg=tB("input",{margin:"0",padding:"0 1rem 0 2rem",background:"none",zIndex:"2",height:"2rem",marginLeft:"1rem",marginTop:"1rem",justifyContent:"center",display:"flex",alignItems:"center",fontSize:"1rem",borderRadius:"2rem",fontFamily:"inherit",backgroundColor:"$primary",border:"none",color:"$secondary",cursor:"text",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important",flexGrow:"0",width:"100%","&:placeholder":{color:"inherit"}}),rv=tB("span",{position:"absolute",zIndex:"3",width:"2rem",height:"2rem",padding:"8px",marginTop:"1rem",marginLeft:"1rem",color:"$secondary",fill:"$secondary",stroke:"$secondary",transition:"$all",cursor:"text"}),ry=tB("button",{opacity:"1",display:"flex",alignItems:"center",borderRadius:"2rem",width:"2rem",height:"2rem",alignSelf:"center",marginTop:"1rem",gap:"0.35rem",backgroundColor:"$accent",fill:"$secondary",flexShrink:"0",svg:{padding:"6px",color:"inherit",fill:"inherit"},'&[aria-disabled="true"]':{opacity:"0",display:"none"}}),rw=tB("form",{display:"flex",justifyContent:"space-between",gap:"1rem",width:"100%",variants:{isPanelExpanded:{true:{[`${rv}`]:{marginLeft:"0"},[`& ${rg}`]:{marginLeft:"0",backgroundColor:"$primary",width:"auto",flexGrow:"1"}},false:{}}}}),rb=tB("div",{}),rx={charset:"latin:extra, arabic:extra, cyrillic:extra, cjk:extra",optimize:!0,tokenize:"full",resolution:9,document:{id:"id",index:"content"}},it=({isPanelExpanded:m})=>{let{state:v}=(0,O.useContext)(tN),{annotations:w,searchString:E=""}=v,C=new tF.Z.Document(rx),S=[];function c(m){return m.map(m=>null==w?void 0:w.filter(v=>v.body.find(v=>v.id===m)).map(v=>{let w=v.body.findIndex(v=>v.id===m);return{...v,body:v.body[w]}}).shift())}null==w||w.forEach(m=>{var v;null==(v=null==m?void 0:m.body)||v.forEach(m=>{var v;let w=null==(v=null==m?void 0:m.value)?void 0:v.replace(/\n/g,"");S.push(null==m?void 0:m.id),C.add({id:null==m?void 0:m.id,content:w})})});let A=null==C?void 0:C.search(E).reduce((m,v)=>[...new Set([...m,...v.result])],[]),_={found:c(A),notFound:c(S.filter(m=>!A.includes(m)))},g=m=>{var v;m&&(null==(v=null==document?void 0:document.getElementById(m))||v.scrollIntoView({behavior:"smooth"}))};return O.createElement(rb,null,O.createElement(rf,null,_.found.map(v=>O.createElement("button",{"data-result":"true",disabled:!m,onClick:()=>g(v.body.id),key:v.id},O.createElement(rh,null,O.createElement(rm,null,v.motivation),O.createElement("span",null,v.body.language)),O.createElement("span",null,v.body.value.slice(0,150),"..."))),_.notFound.map(v=>O.createElement("button",{"data-result":"false",disabled:!m,key:v.id,onClick:()=>g(v.body.id)},O.createElement(rh,null,O.createElement(rm,null,v.motivation),O.createElement("span",null,v.body.language)),O.createElement("span",null,v.body.value.slice(0,150),"...")))))},at=()=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},O.createElement("title",null,"Search"),O.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),lt=()=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},O.createElement("title",null,"Close"),O.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),st=({togglePanel:m,isPanelExpanded:v})=>{let{dispatch:w,state:E}=(0,O.useContext)(tN),{searchString:C}=E,S=(0,O.useRef)(null),c=()=>S.current===document.activeElement&&m(!0),s=()=>{var v;null==(v=S.current)||v.blur(),g(),m(!1),w({payload:"",type:"updateSearchString"})},g=()=>{S.current&&(S.current.value="")},h=m=>{"Escape"===m.key&&(m.preventDefault(),s())};return(0,O.useEffect)(()=>(null==document||document.addEventListener("keydown",h),()=>{null==document||document.removeEventListener("keydown",h)}),[]),(0,O.useEffect)(()=>{if(null!=S&&S.current)return S.current.addEventListener("focus",c),S.current.addEventListener("blur",c),()=>{S.current&&(S.current.removeEventListener("focus",c),S.current.removeEventListener("blur",c))}},[]),O.createElement(rw,{id:"scroll-search",autoComplete:"off",isPanelExpanded:v},O.createElement(rv,{onClick:()=>{var m;return null==(m=null==S?void 0:S.current)?void 0:m.focus()}},O.createElement(at,null)),O.createElement(rg,{ref:S,name:"clover-search",type:"text",placeholder:"Search...",defaultValue:C,onChange:m=>{var v;w({payload:null==(v=null==m?void 0:m.target)?void 0:v.value,type:"updateSearchString"})}}),O.createElement(ry,{"aria-disabled":!v,"aria-label":"Close search panel",onClick:m=>{m.preventDefault(),s()},disabled:!v},O.createElement(lt,null)))},rE=tB("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maxWidth:"100%",marginTop:"1rem",transition:"$all",variants:{isPanelExpanded:{true:{zIndex:1,opacity:1,transform:"translateX(0)"},false:{zIndex:-1,opacity:0,transform:"translateX(-2.618rem)",transitionDelay:"0",transition:"none"}}}}),dt=m=>{let[v,w]=(0,O.useState)({top:0,left:0});return(0,O.useEffect)(()=>{let a=()=>{if(m.current){let v=m.current.getBoundingClientRect();w({top:v.top,left:v.left})}};return window.addEventListener("scroll",a),window.addEventListener("resize",a),a(),()=>{window.removeEventListener("scroll",a),window.removeEventListener("resize",a)}},[m]),v},mt=({isPanelExpanded:m,handlePanel:v})=>{var w;let E=(0,O.useRef)(null),{state:C}=(0,O.useContext)(tN),{options:S}=C,{offset:A}=S,{top:_}=dt(E),k=!!_&&_<A,I=null==(w=null==E?void 0:E.current)?void 0:w.offsetWidth,P=I&&.5*I,T={top:k?A:0,width:`calc(${P}px - 1.318rem)`,maxWidth:m?"100%":`${P?P-315:180}px`,minWidth:"130px"};return O.createElement(tQ,{ref:E,className:k?"anchor":"","data-testid":"scroll-panel"},O.createElement(tX,{style:T},O.createElement(st,{togglePanel:v,isPanelExpanded:m}),O.createElement(rE,{"data-testid":"scroll-panel-results","data-panel-expanded":m,isPanelExpanded:m},O.createElement(it,{isPanelExpanded:m}))))},ut=({items:m})=>{let[v,w]=(0,O.useState)(!1);return O.createElement(O.Fragment,null,O.createElement(mt,{isPanelExpanded:v,handlePanel:m=>w(m)}),O.createElement(t4,{"data-figures-visible":!v},m.map((v,w)=>{let E=w+1,C=E===m.length;return O.createElement(ru,{item:v,hasItemBreak:E<m.length,isLastItem:C,key:v.id,itemCount:m.length,itemNumber:E})})))},pt=(m,v)=>{let[w,E]=(0,O.useState)([]);return(0,O.useEffect)(()=>{if(!v)return;let w=[];null==m||m.forEach(m=>{var E;let C=v.get(m);null==(E=null==C?void 0:C.annotations)||E.forEach(m=>{var E;let C=v.get(m);null==(E=null==C?void 0:C.items)||E.forEach(m=>{var E;let C=v.get(m);C&&w.push({...C,body:null==(E=null==C?void 0:C.body)?void 0:E.map(m=>v.get(m))})})})});let C=w.reduce((m,v)=>(m.some(m=>m.id===v.id)||m.push(v),m),[]);E(C)},[m,v]),w},ht=({iiifContent:m})=>{let[v,w]=(0,O.useState)(),{state:E,dispatch:C}=(0,O.useContext)(tN),{vault:S}=E,A=pt(null==v?void 0:v.items,S);return(0,O.useEffect)(()=>{S&&S.load(m).then(m=>m&&w(m)).catch(v=>console.error(`Manifest ${m} failed to load: ${v}`))},[m,S]),(0,O.useEffect)(()=>{C({type:"updateAnnotations",payload:A})},[A,C]),v?O.createElement(tJ,null,v.label&&O.createElement(ve,{label:v.label}),v.items&&O.createElement(ut,{items:v.items})):null},zt=({iiifContent:m,options:v})=>O.createElement(te,{options:v},O.createElement(ht,{iiifContent:m}));var rC=w(9897),rS=w(334),rA=w(434),r_=w(150),rk=w(9821),rI=w(1876).Buffer;function p(m){return m.endsWith("info.json")?m:m.endsWith("/")?`${m}info.json`:`${m}/info.json`}let r$="http://library.stanford.edu/iiif/image-api/compliance.html#level1",rP="http://library.stanford.edu/iiif/image-api/compliance.html#level2",rT="http://library.stanford.edu/iiif/image-api/conformance.html#level1",rR="http://library.stanford.edu/iiif/image-api/conformance.html#level2",rO="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",rM="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",rz="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",rL="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",rj="http://iiif.io/api/image/1/level1.json",rF="http://iiif.io/api/image/1/profiles/level1.json",rH="http://iiif.io/api/image/1/level2.json",rN="http://iiif.io/api/image/1/profiles/level2.json",rB="http://iiif.io/api/image/2/level1.json",rD="http://iiif.io/api/image/2/profiles/level1.json",rW="http://iiif.io/api/image/2/level2.json",rV="http://iiif.io/api/image/2/profiles/level2.json",rU="level1",rq="level2",rG="http://iiif.io/api/image/2/level1",rZ="http://iiif.io/api/image/2/level2",rX=[rZ,rP,rR,rM,rL,rH,rN,rW,rV,rq],rQ=[...rX,rG,r$,rT,rO,rz,rj,rF,rB,rD,rU],rY=["http://iiif.io/api/image/2/level0",rG,rZ,"http://library.stanford.edu/iiif/image-api/compliance.html#level0",r$,rP,"http://library.stanford.edu/iiif/image-api/conformance.html#level0",rT,rR,"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",rO,rM,"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",rz,rL,"http://iiif.io/api/image/1/level0.json","http://iiif.io/api/image/1/profiles/level0.json",rj,rF,rH,rN,"http://iiif.io/api/image/2/level0.json","http://iiif.io/api/image/2/profiles/level0.json",rB,rD,rW,rV,"level0",rU,rq],rJ={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},rK={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},r0={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function esm_h(m){return m["@id"]?m["@id"]:m.id?m.id:void 0}function esm_w(m){if(!m||!m.profile||!esm_h(m))return!1;let v=Array.isArray(m.profile)?m.profile:[m.profile];for(let m of v)if("string"==typeof m&&-1!==rY.indexOf(m))return!0;return!1}function esm_v(m,v){if(v&&v.profile){let w=v.profile;if(w){let v=Array.isArray(w)?w:[w];return v.includes(`level${m}`)||v.includes(`http://iiif.io/api/image/2/level${m}.json`)||v.includes(`http://iiif.io/api/image/1/level${m}.json`)||v.includes(`http://iiif.io/api/image/1/profiles/level${m}.json`)}}return!1}function esm_F(m){return esm_w(m)?esm_v(0,m)?0:esm_v(1,m)?1:esm_v(2,m)?2:null:null}function esm_X(m){return -1!==(m["@context"]?Array.isArray(m["@context"])?m["@context"]:[m["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")}function esm_Y(m){let v=m.match(/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/);if(v){let w=v[1],E=parseInt(v[4],10),C=parseInt(v[5],10),S=v[7];if(("max"===w||"full"===w)&&E&&C&&S)return{type:"fixed",id:m,height:C,width:E}}return{type:"unknown",id:m}}function esm_q(m){let v=[],w=m.length;for(let E=0;E<w;E++){let w=function(m){return esm_w(m)?(m&&m.sizes?m.sizes:[]).map(v=>({id:esm_h(m),type:"fixed-service",height:v.height,width:v.width,level:esm_F(m),version:esm_X(m)?3:2})):[]}(m[E]);w.length&&v.push(...w);let C=function(m){if(!function(m){if(!esm_w(m))return!1;let v=Array.isArray(m.profile)?m.profile:[m.profile];for(let m of v)if("string"==typeof m){if(-1!==rQ.indexOf(m))return!0}else{let v=[...m.supports||[],...m.extraFeatures||[]];if(-1!==v.indexOf("regionByPx")&&(-1!==v.indexOf("sizeByW")||-1!==v.indexOf("sizeByWh")))return!0}return!1}(m))return[];let v=[],w=Array.isArray(m.profile)?m.profile:[m.profile],E=w.length;for(let v=0;v<E;v++){let E=w[v];if("string"!=typeof E&&(E.maxHeight||E.maxWidth))return[{id:esm_h(m),type:"variable",minWidth:0,minHeight:0,maxHeight:E.maxHeight||E.maxWidth,maxWidth:E.maxWidth||E.maxHeight,level:esm_F(m),version:"http://iiif.io/api/image/3/context.json"===m["@context"]?3:2}]}if(m.tiles){let w=m.tiles.length;for(let E=0;E<w;E++){let w=m.tiles[E];(w.height||w.width)&&v.push({id:esm_h(m),type:"variable",minHeight:0,minWidth:0,maxHeight:w.height||w.width,maxWidth:w.width,level:esm_F(m),version:esm_X(m)?3:2})}}return v}(m[E]);C.length&&v.push(...C)}return v}function esm_ee(m){let v=m.service?Array.isArray(m.service)?m.service:[m.service]:[],w=v.length,E=[];for(let m=0;m<w;m++)esm_w(v[m])&&E.push(v[m]);return E}var r1=Object.defineProperty,r2=Object.defineProperties,r4=Object.getOwnPropertyDescriptors,r3=Object.getOwnPropertySymbols,r6=Object.prototype.hasOwnProperty,r5=Object.prototype.propertyIsEnumerable,esm_$e=(m,v,w)=>v in m?r1(m,v,{enumerable:!0,configurable:!0,writable:!0,value:w}):m[v]=w,x=(m,v)=>{for(var w in v||(v={}))r6.call(v,w)&&esm_$e(m,w,v[w]);if(r3)for(var w of r3(v))r5.call(v,w)&&esm_$e(m,w,v[w]);return m},esm_I=(m,v)=>r2(m,r4(v));function esm_O(m,v,w){let E=function(m){let v=function(m,v=""){let{path:w,scheme:E,server:C,prefix:S}=function(m,v=""){let w=m.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!w)throw Error(`Invalid or unknown input ${m}`);let E=w[2],C=w[3],S=w[4];if("/"===S[0]&&(S=S.substr(1)),v.length>0){if("/"===v[0]&&(v=v.substr(1)),v!==S.substr(0,v.length))throw Error(`Path does not start with prefix (path: ${S}, prefix: ${v})`);S=S.substr(v.length)}return{scheme:E,server:C,path:S,prefix:v}}(m,v),A=w.split("/").reverse(),[_,k,I,P,...T]=A,R=T.reverse().filter(Boolean).join("/");if(1===A.length||""===_)return{type:"base",scheme:E,server:C,prefix:S,identifier:R};if("info.json"===_){let[,...m]=A;return{type:"info",scheme:E,server:C,prefix:S,identifier:m.reverse().filter(Boolean).join("/")}}let O=_.split(".");return{type:"image",scheme:E,server:C,prefix:S,identifier:R,originalPath:w,region:function(m){try{if("full"===m)return{full:!0};if("square"===m)return{square:!0};let v=m.startsWith("pct:"),w=m.substr(v?4:0).split(",").map(m=>parseFloat(m));return{x:w[0],y:w[1],w:w[2],h:w[3],percent:v}}catch{throw Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+m)}}(P),size:function(m){let v={upscaled:!1,max:!1,confined:!1};if("^"===m[0]&&(v.upscaled=!0,m=m.slice(1)),"max"===m||"full"===m)return v.max=!0,v.serialiseAsFull="full"===m,v;if("!"===m[0]&&(v.confined=!0,m=m.slice(1)),"p"===m[0])return v.percentScale=parseFloat(m.slice(4)),v;let w=m.split(",").map(m=>m.trim());return w.length&&(""!==w[0]&&(v.width=parseInt(w[0],10)),""!==w[1]?(v.height=parseInt(w[1],10),v.version=2):v.version=3),v}(I),rotation:function(m){let v={angle:0};if("!"===m[0]&&(v.mirror=!0,m=m.substr(1)),v.angle=parseFloat(m)%360,Number.isNaN(v.angle))throw Error(`Invalid rotation ${m}`);return v}(k),quality:O[0],format:O[1]}}(p(m.id));if("info"!==v.type)throw Error("Invalid service URL");let w=function(m){let v=m?Array.isArray(m.profile)?m.profile:[m.profile]:[],w={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let m of v){var E;if("string"==typeof m&&(E=m,m=-1!==rX.indexOf(E)?r0:-1!==rQ.indexOf(E)?rK:rJ),m){if(m.formats)for(let v of m.formats)-1===w.extraFormats.indexOf(v)&&w.extraFormats.push(v);if(m.qualities)for(let v of m.qualities)-1===w.extraQualities.indexOf(v)&&w.extraQualities.push(v);if(m.supports)for(let v of m.supports)-1===w.extraFeatures.indexOf(v)&&w.extraFeatures.push(v);if(m.maxHeight&&(w.maxHeight=m.maxHeight),m.maxWidth&&(w.maxWidth=m.maxWidth),m.maxArea&&(w.maxArea=m.maxArea),m.extraFormats)for(let v of m.extraFormats)-1===w.extraFormats.indexOf(v)&&w.extraFormats.push(v);if(m.extraQualities)for(let v of m.extraQualities)-1===w.extraQualities.indexOf(v)&&w.extraQualities.push(v);if(m.extraFeatures)for(let v of m.extraFeatures)-1===w.extraFeatures.indexOf(v)&&w.extraFeatures.push(v);m.maxHeight&&(w.maxHeight=m.maxHeight),m.maxWidth&&(w.maxWidth=m.maxWidth),m.maxArea&&(w.maxArea=m.maxArea)}}if(m.extraFormats)for(let v of m.extraFormats)-1===w.extraFormats.indexOf(v)&&w.extraFormats.push(v);if(m.extraFeatures)for(let v of m.extraFeatures)-1===w.extraFeatures.indexOf(v)&&w.extraFeatures.push(v);if(m.extraQualities)for(let v of m.extraQualities)-1===w.extraQualities.indexOf(v)&&w.extraQualities.push(v);return w}(m);return{identifier:v.identifier,originalPath:"",server:v.server,prefix:v.prefix,scheme:v.scheme,type:"image",quality:-1===w.extraQualities.indexOf("default")?w.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}({"@context":3===m.version?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:p(esm_h(m)),profile:null===m.level||typeof m.level>"u"?"level0":`level${m.level}}`,type:3===m.version?"ImageService3":"ImageService2"});if("image"!==E.type)throw Error("Invalid service");return E.size.max=!1,E.size.width=v,E.size.height=w,{id:function(m,v){let w=m.prefix.startsWith("/")?m.prefix.substr(1):m.prefix,E=`${m.scheme}://${m.server}/${w?`${w}/`:""}${m.identifier}`;if("base"===m.type)return E;if("info"===m.type)return`${E}/info.json`;let{size:C}=m,{region:S,rotation:A,format:_,quality:k}=m;if(v){let m=v["@context"]?Array.isArray(v["@context"])?v["@context"]:[v["@context"]]:[],w=-1!==m.indexOf("http://iiif.io/api/image/2/context.json"),E=-1!==m.indexOf("http://iiif.io/api/image/3/context.json");if((C.width!==v.width||C.height)&&(C.height!==v.height||C.width)&&(C.width!==v.width||C.height!==v.height)||(C=esm_I(x({},C),{max:!0})),w&&(C.max&&!C.serialiseAsFull&&(C=esm_I(x({},C),{serialiseAsFull:!0})),!C.max&&C.width&&C.height&&(C=esm_I(x({},C),{height:void 0})),C=esm_I(x({},C),{version:2})),E){if(C.max&&C.serialiseAsFull&&(C=esm_I(x({},C),{serialiseAsFull:!1})),C.width&&!C.height&&v.width&&v.height){let m=v.height/v.width;C=esm_I(x({},C),{height:Math.ceil(C.width*m)})}C=esm_I(x({},C),{version:3})}}return[E,function({x:m=0,y:v=0,w:w,h:E,full:C,square:S,percent:A}){if(C)return"full";if(S)return"square";if(typeof w>"u"||typeof E>"u")throw Error("RegionParameter: invalid region");let _=`${m},${v},${w},${E}`;return A?`pct:${_}`:_}(S),function({max:m,percentScale:v,upscaled:w,confined:E,width:C,height:S,serialiseAsFull:A,version:_}){let k=[];return w&&k.push("^"),m?k.push(A?"full":"max"):(E&&k.push("!"),v&&k.push(`pct:${v}`),C&&k.push(`${C}`),k.push(","),S&&3===_&&k.push(`${S}`)),k.join("")}(C),`${A.mirror?"!":""}${(A.angle||0)%360}`,`${k}.${_}`].filter(Boolean).join("/")}(E),type:"fixed",width:v,height:w||m.height/(m.width||1)*v,unsafe:m.width>v}}function esm_y(m){let v=m.replace(/(https?:\/\/)?(www.)?/i,"");return -1!==v.indexOf("/")?v.split("/")[0]:v}var r8=Object.defineProperty,r9=Object.defineProperties,r7=Object.getOwnPropertyDescriptors,ie=Object.getOwnPropertySymbols,ii=Object.prototype.hasOwnProperty,ia=Object.prototype.propertyIsEnumerable,esm_Re=(m,v,w)=>v in m?r8(m,v,{enumerable:!0,configurable:!0,writable:!0,value:w}):m[v]=w,ri=(m,v)=>{for(var w in v||(v={}))ii.call(v,w)&&esm_Re(m,w,v[w]);if(ie)for(var w of ie(v))ia.call(v,w)&&esm_Re(m,w,v[w]);return m},si=(m,v)=>r9(m,r7(v)),esm_=(m,v,w)=>new Promise((E,C)=>{var s=m=>{try{o(w.next(m))}catch(m){C(m)}},a=m=>{try{o(w.throw(m))}catch(m){C(m)}},o=m=>m.done?E(m.value):Promise.resolve(m.value).then(s,a);o((w=w.apply(m,v)).next())});new class{constructor(){this.config={verificationsRequired:1,approximateServices:!0,enableFetching:!0,disableThrottling:!1},this.fetchingCount=0,this.imageServices={},this.knownImageServers={}}setConfig(m){Object.assign(this.config,m)}sample(m,v,w=!0){let E=esm_y(esm_h(m)),C=p(esm_h(m)),S=this.knownImageServers[E];return this.imageServices[C]=Object.assign(m,{real:!0}),S||!m.tiles||esm_v(0,m)?this.verify(m):(this.knownImageServers[E]={verifications:0,malformed:!1,root:E,preLoaded:w,sampledId:esm_h(m),verified:!1,server:null,result:{context:m["@context"]||[],sampledProfile:m.profile,resourceServiceRatio:v&&m.height?v.height/m.height:1,sampledSizes:m.sizes||[],sizeRatios:function(m,v,w){let E=w.length,C=[];for(let v=0;v<E;v++){let E=w[v].width;C.push(m/E)}return C}(m.width,m.height,m.sizes||[]),sampledTiles:m.tiles||[]}},!0)}preLoad(m,v=!0){this.knownImageServers[m.root]=m,v&&(this.knownImageServers[m.root].malformed=!1,this.knownImageServers[m.root].verifications=this.config.verificationsRequired)}predict(m,v=!1,w=!1){let E=null==m?void 0:m.source,C=esm_y(esm_h(m)),S=this.knownImageServers[C];if(!S||!S.result||!((null==E?void 0:E.height)||m.height)||!((null==E?void 0:E.width)||m.width)||!w&&(S.malformed||S.verifications<this.config.verificationsRequired)||esm_v(0,m.source))return null;let A=p(esm_h(m));return this.imageServices[A]||(this.imageServices[A]={"@context":S.result.context,"@id":esm_h(m),id:esm_h(m),protocol:"http://iiif.io/api/image",tiles:(null==E?void 0:E.tiles)||function(m,v,w){let E=m>v?m:v,C=w.length,S=[];for(let m=0;m<C;m++){let v=w[m],C=v.scaleFactors[0],A=E/C,_=[C];for(;A>=v.width;)_.push(C*=2),A/=2;S.push(si(ri({},v),{scaleFactors:_}))}return S}(m.width,m.height,S.result.sampledTiles),sizes:(null==E?void 0:E.sizes)||function(m,v,w){let E=w.length,C=[];for(let S=0;S<E;S++){let E=w[S];C.push({width:Math.floor(m/E),height:Math.floor(v/E)})}return C}(Math.round(m.width/S.result.resourceServiceRatio),Math.round(m.height/S.result.resourceServiceRatio),S.result.sizeRatios),profile:(null==E?void 0:E.profile)||S.result.sampledProfile,height:(null==E?void 0:E.height)||m.height,width:(null==E?void 0:E.width)||m.width,real:!1}),this.imageServices[A]}getThumbnailFromResource(m,v){return esm_(this,arguments,function*(m,v,w=!0,E=[]){let C=m?yield this.getImageCandidates(m,w):[];return function(m,v){let w=[],E=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},m),r=(m,v=0)=>E.explain?w.push(Array(v).fill(0).map(m=>"    ").join("")+m().trim()):void 0,C=[],S=[],A=null;r(()=>`Using configuration: ${JSON.stringify(E,null,2)}`);let f=(m,v)=>{if(r(()=>"Swapping choice",3),function(m,v,w){let E=m.width?m.width:m.maxWidth;return w.height<=m.maxHeight&&w.width<=m.maxWidth&&w.height>=m.minHeight&&w.width>=m.minWidth&&(!v||Math.abs(w.width-E)<Math.abs(v.width-E))}(E,v,m)){if(E.preferFixedSize&&m.unsafe){r(()=>`We found an image that was marked as unsafe, but it was the best size. (${m.id})`,4),S.push(m);return}E.returnAllOptions&&v&&S.push(v),r(()=>`We found a new image that was the best size. (${m.id})`,4),A=m}else E.returnAllOptions&&S.push(m)};r(()=>`The input shows we have ${v.length} list(s) of candidates to choose from.`);let _=v.length;for(let m=0;m<_;m++){let w=v[m]();r(()=>`Candidate group ${m}: ${JSON.stringify(w,null,2)}`,1);let S=w.length;r(()=>`Checking candidate list number ${m} and found ${S} potential ways of creating image(s)`,1);for(let m=0;m<S;m++){let v=w[m];if(r(()=>`-> Checking candidate ${m}`,1),"unknown"===v.type&&E.atAnyCost&&(r(()=>'We\'ve found an unknown image type, adding this to the "last resort" list',2),C.push(v)),"fixed"===v.type&&(v.unsafe?(r(()=>'We\'ve found an unsafe fixed image type, adding this to the "last resort" list',2),C.push(v)):(r(()=>"We've found a fixed size image, checking if it matches the request",2),f(v,A))),"fixed-service"===v.type){if(E.unsafeImageService){r(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);let m=esm_O(v,E.width,E.height);f(m,A)}else{r(()=>"Checking for an image from the tile source 3",2);let m=esm_O(v,v.width,v.height);f(m,A)}}if("variable"===v.type&&v.maxWidth){let m=esm_O({id:v.id,type:"fixed-service",width:v.maxWidth,height:v.maxWidth,level:v.level,version:v.version},v.maxWidth);f(m,A)}}if(A&&!E.returnAllOptions){if(A.unsafe||E.allowUnsafe)continue;r(()=>`We found a match in choice list number ${m}, no searching any more`);break}}return E.atAnyCost&&0===S.length?(r(()=>A?`We found an image! ${A.id} of type ${A.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:A||C[0],fallback:C.slice(1),log:w}):E.returnAllOptions?(r(()=>"Returning all options that we have found"),{best:E.atAnyCost?A||S[0]||C[0]:A||S[0],fallback:[...S,...C],log:w}):(r(()=>"Returning the best image that we found, and a fallback"),{best:A||S[0]||null,fallback:A?S:S.slice(1),log:w})}(v,[()=>E,()=>C])})}getImageCandidates(m,v=!0){return esm_(this,null,function*(){if(v&&m.height&&m.width){let v=esm_ee(m);for(let w of v){let v={id:esm_h(w),width:w.width?w.width:m.width,height:w.height?w.height:m.height,source:w};yield this.loadService(v)}}return function(m,v=!0,w){let E=[],C=function(m){if("string"==typeof m)return esm_Y(m);let v=m["@type"]?m["@type"]:m.type?m.type:void 0;if("Image"!==v&&"sc:Image"!==v)return null;let w=esm_h(m);return w?w&&m.width&&m.height?{id:w,type:"fixed",width:m.width,height:m.height,unsafe:!0}:esm_Y(w):null}(m);if(null===C)return E;if(E.push(C),v&&m.width&&m.height){let v=[],C=esm_ee(m);for(let E of C){let C={id:esm_h(E),width:m.width,height:m.height};if(w.canLoadSync(C)){let E=w.loadServiceSync(C);E&&(E.height||(E.height=m.height),E.width||(E.width=m.width),v.push(...esm_q([E])))}}if(v.length)return E.push(...v),E}return m.service&&E.push(...esm_q(m.service)),E}(m,v,this)})}verify(m){return esm_(this,null,function*(){let v=this.predict(m,!1,!0),w=yield this.fetchService(esm_h(m));if(!v)return!1;let E=v.height===w.height&&v.width===w.width&&v["@context"]===w["@context"]&&function(m,v){if(m.length!==v.length)return!1;if(0===m.length&&0===v.length)return!0;let w=m.length,E=!0;for(let C=0;C<w;C++){let w=m[C],S=v[C];if(w.width!==S.width||w.height!==S.height){E=!1;break}}if(E)return!0;let C=0;for(let E=0;E<w;E++)for(let S=0;S<w;S++)if(m[E].width===v[S].width&&m[E].height===v[S].height){C++;break}return C===w}(v.sizes||[],w.sizes||[]);if(E){let v=esm_y(esm_h(m));this.knownImageServers[v].verifications+=1,this.knownImageServers[v].verifications>=this.config.verificationsRequired&&(this.knownImageServers[v].verified=!0)}return E})}canLoadSync(m){let v="string"==typeof m?m:esm_h(m),w=p(v);if(this.imageServices[w])return!0;let E=this.knownImageServers[esm_y(v)];return E&&!E.malformed&&E.verifications>=this.config.verificationsRequired}markAsMalformed(m){return esm_(this,null,function*(){return this.knownImageServers[esm_y(esm_h(m))].malformed=!0,this.loadService(m,!0)})}fetchService(m,v=!1){return esm_(this,null,function*(){let w=p(m);if(this.imageServices[w]&&(!v||this.imageServices[w].real))return this.imageServices[w];if(!this.config.enableFetching)throw Error("Fetching is not enabled");let E=yield this.fetch(w).then(m=>m.json());return!E.id&&E["@id"]&&(E.id=E["@id"]),E.id!==m&&(E.id=m,E["@id"]&&(E["@id"]=m)),this.imageServices[w]=Object.assign(E,{real:!0}),this.imageServices[w]})}fetch(m,v){return esm_(this,null,function*(){return fetch(m,v)})}loadService(m,v=!1){return esm_(this,null,function*(){if(!this.config.disableThrottling){let m=!0;for(;m;)if(this.fetchingCount>=this.config.verificationsRequired)yield new Promise(m=>setTimeout(m,500));else{m=!1;break}}let w=this.knownImageServers[esm_y(esm_h(m))];if(w&&!w.malformed&&!v){yield w.result;let v=this.loadServiceSync(m);if(v)return v}this.fetchingCount++;let E=yield this.fetchService(esm_h(m),v);return this.fetchingCount--,E.real&&this.sample(E,m),E})}loadServiceSync(m){let v=p(esm_h(m));return this.imageServices[v]?this.imageServices[v]:this.predict(m)}},Symbol.for("_refs_"),Symbol.for("_reactive_"),Symbol.for("_defined_");var io=w(6419),il=w(5059),is=w(761);let Wt=m=>{let v=m.toString().split(":"),w=Math.ceil(parseInt(v[0])),E=Math.ceil(parseInt(v[1])),C=Gt(Math.ceil(parseInt(v[2])),2),S=`${0!==w&&E<10?(E+"").padStart(2,"0"):E}:${C}`;return 0!==w&&(S=`${w}:${S}`),S},viewer_We=m=>{let v=new Date(1e3*m).toISOString().substr(11,8);return Wt(v)},viewer_De=(m,v)=>{if("object"!=typeof m||null===m)return v;for(let w in v)"object"!=typeof v[w]||null===v[w]||Array.isArray(v[w])?m[w]=v[w]:(m[w]||(m[w]={}),m[w]=viewer_De(m[w],v[w]));return m},Dt=m=>m.split("").reduce(function(m,v){return(m=(m<<5)-m+v.charCodeAt(0))&m},0),viewer_Ge=(m,v)=>Object.hasOwn(m,v)?m[v].toString():void 0,Gt=(m,v)=>String(m).padStart(v,"0"),ic={annotationOverlays:{backgroundColor:"#ff6666",borderColor:"#990000",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:2},background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"500px",ignoreCaptionLabels:[],informationPanel:{vtt:{autoScroll:{enabled:!0,settings:{behavior:"smooth",block:"center"}}},open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0,renderAnnotation:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showIIIFBadge:!0,showTitle:!0,withCredentials:!1};function viewer_Ue(m){let v={...ic.informationPanel.vtt.autoScroll};return"object"==typeof m&&(v="enabled"in m?m:{enabled:!0,settings:m}),!1===m&&(v.enabled=!1),function({behavior:m,block:v}){let w=["auto","instant","smooth"],E=["center","end","nearest","start"];if(!w.includes(m))throw TypeError(`'${m}' not in ${w.join(" | ")}`);if(!E.includes(v))throw TypeError(`'${v}' not in ${E.join(" | ")}`)}(v.settings),v}let id=viewer_Ue(null==(k=null==(_=null==ic?void 0:ic.informationPanel)?void 0:_.vtt)?void 0:k.autoScroll),iu={activeCanvas:"",activeManifest:"",collection:{},configOptions:ic,customDisplays:[],isAutoScrollEnabled:id.enabled,isAutoScrolling:!1,isInformationOpen:null==(I=null==ic?void 0:ic.informationPanel)?void 0:I.open,isLoaded:!1,isUserScrolling:void 0,vault:new Vault,openSeadragonViewer:null,viewerId:esm_browser_v4()},ip=O.createContext(iu),im=O.createContext(iu);function Zt(m,v){switch(v.type){case"updateActiveCanvas":return v.canvasId||(v.canvasId=""),{...m,activeCanvas:v.canvasId};case"updateActiveManifest":return{...m,activeManifest:v.manifestId};case"updateAutoScrollAnnotationEnabled":return{...m,isAutoScrollEnabled:v.isAutoScrollEnabled};case"updateAutoScrolling":return{...m,isAutoScrolling:v.isAutoScrolling};case"updateCollection":return{...m,collection:v.collection};case"updateConfigOptions":return{...m,configOptions:viewer_De(m.configOptions,v.configOptions)};case"updateInformationOpen":return{...m,isInformationOpen:v.isInformationOpen};case"updateIsLoaded":return{...m,isLoaded:v.isLoaded};case"updateUserScrolling":return{...m,isUserScrolling:v.isUserScrolling};case"updateOpenSeadragonViewer":return{...m,openSeadragonViewer:v.openSeadragonViewer};case"updateViewerId":return{...m,viewerId:v.viewerId};default:throw Error(`Unhandled action type: ${v.type}`)}}let Xt=({initialState:m=iu,children:v})=>{let[w,E]=(0,O.useReducer)(Zt,m);return O.createElement(ip.Provider,{value:w},O.createElement(im.Provider,{value:E},v))};function viewer_I(){let m=O.useContext(ip);if(void 0===m)throw Error("useViewerState must be used within a ViewerProvider");return m}function viewer_F(){let m=O.useContext(im);if(void 0===m)throw Error("useViewerDispatch must be used within a ViewerProvider");return m}let Yt=(m,v)=>{let w=m.get({id:v,type:"Canvas"});return null!=w&&w.annotations&&w.annotations[0]?m.get(w.annotations).filter(m=>!!m.items&&!!m.items.length&&m).map(m=>{let v=m.label||{none:["Annotations"]};return{...m,label:v}}):[]},viewer_Ze=(m,v,w,E)=>{var C,S;let A={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]};if(A.canvas=m.get(v),A.canvas&&(A.annotationPage=m.get(A.canvas.items[0]),A.accompanyingCanvas=null!=(C=A.canvas)&&C.accompanyingCanvas?m.get(null==(S=A.canvas)?void 0:S.accompanyingCanvas):void 0),A.annotationPage){let C=m.get(A.annotationPage.items).map(v=>({body:m.get(v.body[0].id),motivation:v.motivation,type:"Annotation"})),S=[];C.forEach(v=>{"Choice"===v.body.type?v.body.items.forEach(w=>S.push({...v,id:w.id,body:m.get(w.id)})):S.push(v)}),A.annotations=S.filter(C=>{if(C){if(!C.body||!C.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",C);return}let S=C.body;Array.isArray(S)&&(S=S[0]);let A=m.get(S.id);if(A)switch(w){case"painting":return C.target===v.id&&C.motivation&&"painting"===C.motivation[0]&&E.includes(A.type)&&(C.body=A),!!C;case"supplementing":return;default:throw Error("Invalid annotation motivation.")}}})}return A},viewer_U=(m,v="en")=>{if(!m)return"";if(!m[v]){let v=Object.getOwnPropertyNames(m);if(v.length>0)return m[v[0]]}return m[v]},viewer_q=(m,v)=>{let w=viewer_Ze(m,{id:v,type:"Canvas"},"painting",["Image","Sound","Video"]);if(0!==w.annotations.length&&w.annotations&&w.annotations)return w.annotations.map(m=>null==m?void 0:m.body)},Jt=(m,v,w,E)=>{let C=[];if(v.canvas&&v.canvas.thumbnail.length>0){let w=m.get(v.canvas.thumbnail[0]);C.push(w)}if(v.annotations[0]){if(v.annotations[0].thumbnail&&v.annotations[0].thumbnail.length>0){let w=m.get(v.annotations[0].thumbnail[0]);C.push(w)}if(!v.annotations[0].body)return;let w=v.annotations[0].body;"Image"===w.type&&C.push(w)}return 0===C.length?void 0:{id:C[0].id,format:C[0].format,type:C[0].type,width:w,height:E}},ih={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:ig,css:iv,keyframes:iy,createTheme:iw}=(0,R.Th)({theme:{colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:"hsl(209 100% 38.2%)",accentMuted:"hsl(209 80% 61.8%)",accentAlt:"hsl(209 80% 30%)",secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},media:ih}),ib=ig("div",{display:"flex",flexDirection:"column",alignItems:"center"}),ix=ig("p",{fontWeight:"bold",fontSize:"x-large"}),iE=ig("span",{fontSize:"medium"}),viewer_Xe=({error:m})=>{let{message:v}=m;return O.createElement(ib,{role:"alert"},O.createElement(ix,{"data-testid":"headline"},"Something went wrong"),v&&O.createElement(iE,null,`Error message: ${v}`," "))},iC=ig("div",{position:"relative",zIndex:"0"}),iS=ig("div",{display:"flex",flexDirection:"row",flexGrow:"1",overflow:"hidden","@sm":{flexDirection:"column"}}),iA=ig("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),i_=ig(rS.xz,{display:"none",border:"none",padding:"0",transition:"$all",opacity:"1",background:"#6663",margin:"1rem 0",borderRadius:"6px","&[data-information-panel='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",fontSize:"0.8333em",justifyContent:"center",padding:"0.5rem",fontFamily:"inherit"}}}),ik=ig(rS.VY,{width:"100%",display:"flex"}),iI=ig("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%",maxHeight:"100%","@sm":{width:"100%"}}),i$=ig("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased",'&[data-absolute-position="true"]':{position:"absolute",width:"100%",height:"100%",zIndex:"0"},"> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start",height:"100%",maxHeight:"100%","@sm":{[`& ${iS}`]:{flexGrow:"1"},[`& ${iA}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${iC}`]:{display:"none"},[`& ${i_}`]:{margin:"1rem"},[`& ${ik}`]:{height:"100%"}}}}),iP=ig(rA.fC,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% - 2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),iT=ig(rA.aV,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid #6663","@sm":{margin:"0 1rem"}}),iR=ig(rA.xz,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),iO=ig(rA.VY,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),iM=ig(({handleScroll:m,children:v,className:w})=>O.createElement("div",{className:w,onScroll:m},v),{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),iz={position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"inherit",border:"none",background:"none"},iL=ig("button",{textAlign:"left","&:hover":{color:"$accent"}}),ij=ig("div",{display:"flex",flexDirection:"column",width:"100%"}),iF=ig("div",{...iz}),iH=ig("div",{"&:hover":{color:"$accent"}}),viewer_ke=({value:m,handleClick:v})=>O.createElement(iL,{onClick:v},m),un=({value:m,handleClick:v})=>O.createElement(iH,{dangerouslySetInnerHTML:{__html:m},onClick:v}),pn=()=>{function e(m){return m.map(m=>{let v=m.identifier||esm_browser_v4();return{...m,identifier:v}})}return{addIdentifiersToParsedCues:e,createNestedCues:function(m){var v;let w=[],E=[],C=e(m);for(let m of C){for(;E.length>0&&E[E.length-1].end<=m.start;)E.pop();E.length>0?(E[E.length-1].children||(E[E.length-1].children=[]),null==(v=E[E.length-1].children)||v.push(m)):w.push(m),E.push(m)}return w},isChild:function(m,v=[]){return v.some(v=>m.start>=v.start&&m.end<=v.end)},orderCuesByTime:function(m=[]){return m.sort((m,v)=>m.start-v.start)}}},iN=iy({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),iB=ig(r_.fC,{display:"flex",flexDirection:"column",width:"100%"}),iD=ig(r_.ck,{...iz,"@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{backgroundColor:"#6663","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:iN,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:iN,boxSizing:"content-box","@sm":{content:"unset"}}}}),gn=m=>{for(;m&&m!==document.body;){let v=window.getComputedStyle(m).overflowY;if("visible"!==v&&"hidden"!==v&&m.scrollHeight>m.clientHeight)return m;m=m.parentNode}return null},vn=({label:m,start:v,end:w})=>{var E,C;let S=viewer_F(),{configOptions:A,isAutoScrollEnabled:_,isUserScrolling:k}=viewer_I(),I=null==(C=null==(E=null==A?void 0:A.informationPanel)?void 0:E.vtt)?void 0:C.autoScroll,[P,T]=(0,O.useState)(!1),R=(0,O.useRef)(null),z=document.getElementById("clover-iiif-video");return(0,O.useEffect)(()=>(null==z||z.addEventListener("timeupdate",()=>{let{currentTime:m}=z;T(v<=m&&m<w)}),()=>document.removeEventListener("timeupdate",()=>{})),[w,v,z]),(0,O.useEffect)(()=>{var m,v;if(_&&P&&R.current&&!k){let w=R.current;if(w&&w instanceof HTMLElement){let E=gn(w);if(E&&E instanceof HTMLElement){let C;switch(null==(m=null==I?void 0:I.settings)?void 0:m.block){case"center":let A=E.getBoundingClientRect();C=w.offsetTop+w.offsetHeight-Math.floor((A.bottom-A.top)/2);break;case"end":C=w.offsetTop+w.offsetHeight-(E.clientHeight-w.clientHeight)+2;break;default:C=w.offsetTop-2}S({type:"updateAutoScrolling",isAutoScrolling:!0}),E.scrollTo({top:C,left:0,behavior:null==(v=null==I?void 0:I.settings)?void 0:v.behavior}),setTimeout(()=>S({type:"updateAutoScrolling",isAutoScrolling:!1}),750)}}}},[I,P,k,_,S]),O.createElement(iD,{ref:R,"aria-checked":P,"data-testid":"information-panel-cue",onClick:()=>{z&&(z.pause(),z.currentTime=v,z.play())},value:m},m,O.createElement("strong",null,viewer_We(v)))},iW=ig("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${iD}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),viewer_ot=({items:m})=>O.createElement(iW,null,m.map(m=>{let{text:v,start:w,end:E,children:C,identifier:S}=m;return O.createElement("li",{key:S},O.createElement(vn,{label:v,start:w,end:E}),C&&O.createElement(viewer_ot,{items:C}))})),xn=({label:m,vttUri:v})=>{let[w,E]=O.useState([]),{createNestedCues:C,orderCuesByTime:S}=pn(),[A,_]=O.useState();return(0,O.useEffect)(()=>{v&&fetch(v,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(m=>m.text()).then(m=>{let v=(0,rk.parse)(m).cues,w=S(v),A=C(w);E(A)}).catch(m=>{console.error(v,m.toString()),_(m)})},[v]),O.createElement(iB,{"data-testid":"annotation-item-vtt","aria-label":`navigate ${viewer_U(m,"en")}`},A&&O.createElement("div",{"data-testid":"error-message"},"Network Error: ",A.toString()),O.createElement(viewer_ot,{items:w}))},viewer_at=m=>{var v,w;let E={id:"string"==typeof m?m:m.source};if("string"==typeof m){if(m.includes("#xywh=")){let v=m.split("#xywh=");if(v&&v[1]){let[m,w,C,S]=v[1].split(",").map(m=>Number(m));E={id:v[0],rect:{x:m,y:w,w:C,h:S}}}}else if(m.includes("#t=")){let v=m.split("#t=");v&&v[1]&&(E={id:v[0],t:v[1]})}}else"object"==typeof m&&((null==(v=m.selector)?void 0:v.type)==="PointSelector"?E={id:m.source,point:{x:m.selector.x,y:m.selector.y}}:(null==(w=m.selector)?void 0:w.type)==="SvgSelector"&&(E={id:m.source,svg:m.selector.value}));return E},iV=window.OpenSeadragon;if(!iV&&!(iV=P))throw Error("OpenSeadragon is missing.");let iU="http://www.w3.org/2000/svg";iV.Viewer&&(iV.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo||(this._svgOverlayInfo=new viewer_de(this)),this._svgOverlayInfo});let viewer_de=function(m){let v=this;this._viewer=m,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(iU,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(iU,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){v.resize()}),this._viewer.addHandler("open",function(){v.resize()}),this._viewer.addHandler("rotate",function(){v.resize()}),this._viewer.addHandler("flip",function(){v.resize()}),this._viewer.addHandler("resize",function(){v.resize()}),this.resize()};viewer_de.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));let m=this._viewer.viewport.pixelFromPoint(new iV.Point(0,0),!0),v=this._viewer.viewport.getZoom(!0),w=this._viewer.viewport.getRotation(),E=this._viewer.viewport.getFlip(),C=this._viewer.viewport._containerInnerSize.x,S=C*v,A=S;E&&(S=-S,m.x=-m.x+C),this._node.setAttribute("transform","translate("+m.x+","+m.y+") scale("+S+","+A+") rotate("+w+")")},onClick:function(m,v){new iV.MouseTracker({element:m,clickHandler:v}).setTracking(!0)}};let bn=m=>new viewer_de(m),wn=m=>fetch(`${m.replace(/\/$/,"")}/info.json`).then(m=>m.json()).then(m=>m).catch(v=>{console.error(`The IIIF tilesource ${m.replace(/\/$/,"")}/info.json failed to load: ${v}`)}),En=m=>{let v,w;return Array.isArray(m)&&(v=m[0])&&(w="@id"in v?v["@id"]:v.id),w},viewer_me=m=>{var v;let w,E;if(In(m))w=m,E={};else{let C=JSON.parse(function(m){let v=function(m){let v=m.length%4;if(1===v)throw Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");return m+(v?"====".slice(0,4-v):"")}(m),w=v.replace(/-/g,"+").replace(/_/g,"/"),E="undefined"==typeof atob?rI.from(w,"base64").toString("utf-8"):atob(w);return decodeURIComponent(E).trim()}(m));switch(null==C?void 0:C.type){case"SpecificResource":case"Range":case"Annotation":E={manifest:w=null==C?void 0:C.target.partOf[0].id,canvas:null==C?void 0:C.target.id};break;case"Canvas":E={manifest:w=null==C?void 0:C.partOf[0].id,canvas:null==C?void 0:C.id};break;case"Manifest":w=null==C?void 0:C.id,E={collection:null==(v=null==C?void 0:C.partOf[0])?void 0:v.id,manifest:null==C?void 0:C.id};break;case"Collection":E={collection:w=null==C?void 0:C.id}}}return{resourceId:w,active:E}},Sn=m=>{let{resourceId:v,active:w}=viewer_me(m);return w.collection||w.manifest||v},Cn=(m,v)=>{let w=v.items.map(m=>m.id),{active:E}=viewer_me(m),C=E.canvas;return w.includes(C)?C:w[0]},kn=(m,v)=>{let{active:w}=viewer_me(m),E=w.manifest,C=v.items.filter(m=>"Manifest"===m.type).map(m=>m.id);return 0==C.length?null:C.includes(E)?E:C[0]},In=m=>{try{new URL(m)}catch{return!1}return!0};var iq=((A=iq||{}).TiledImage="tiledImage",A.SimpleImage="simpleImage",A);function viewer_Ae(m,v,w,E){let C=function(m){if(!m)return null;let v=document.createElement("template");return v.innerHTML=m.trim(),v.content.children[0]}(v);if(C)for(let v of C.children)!function viewer_it(m,v,w,E){var C;if("#text"===v.nodeName)v.textContent&&(v.textContent.includes(`
`)||console.log("nodeName:",v.nodeName,", textContent:",v.textContent,", childNodes.length",v.childNodes.length));else{let S=function(m,v,w){var E,C,S,A;let _=!1,k=!1,I=!1,P=!1,T=document.createElementNS("http://www.w3.org/2000/svg",m.nodeName);if(m.attributes.length>0)for(let v=0;v<m.attributes.length;v++){let w=m.attributes[v];switch(w.name){case"fill":I=!0;break;case"stroke":_=!0;break;case"stroke-width":k=!0;break;case"fill-opacity":P=!0}T.setAttribute(w.name,w.textContent)}return _||(T.style.stroke=null==(E=v.annotationOverlays)?void 0:E.borderColor),k||(T.style.strokeWidth=null==(C=v.annotationOverlays)?void 0:C.borderWidth),I||(T.style.fill=null==(S=v.annotationOverlays)?void 0:S.backgroundColor),P||(T.style.fillOpacity=null==(A=v.annotationOverlays)?void 0:A.opacity),T.setAttribute("transform",`scale(${w})`),T}(v,w,E),A=bn(m);A.node().append(S),null==(C=A._svg)||C.setAttribute("class","annotation-overlay"),v.childNodes.forEach(v=>{viewer_it(m,v,w,E)})}}(m,v,w,E)}let Ln=m=>{let v=Array.isArray(null==m?void 0:m.service)&&(null==m?void 0:m.service.length)>0,w=v?En(null==m?void 0:m.service):null==m?void 0:m.id,E=v?iq.TiledImage:iq.SimpleImage;return{uri:w,imageType:E}},Fn=(m,v)=>{let w=v?iq.TiledImage:iq.SimpleImage;return{uri:m,imageType:w}},Hn=({caption:m,handleClick:v,imageUri:w})=>O.createElement(iL,{onClick:v},O.createElement("img",{src:w,alt:`A visual annotation for ${m}`}),O.createElement("span",null,m)),On=({annotation:m})=>{var v,w;let{target:E}=m,C=viewer_I(),{openSeadragonViewer:S,vault:A,activeCanvas:_,configOptions:k}=C,I=m.body.map(m=>A.get(m.id)),T=(null==(v=I.find(m=>m.format))?void 0:v.format)||"",R=(null==(w=I.find(m=>m.value))?void 0:w.value)||"",z=A.get({id:_,type:"Canvas"});function h(){var m;if(!E)return;let v=(null==(m=k.annotationOverlays)?void 0:m.zoomLevel)||1,w=viewer_at(E),{point:C,rect:A,svg:_}=w;if(C||A||_){let m=function(m,v,w){let E,C,S=40,A=40;v.rect&&(E=v.rect.x,C=v.rect.y,S=v.rect.w,A=v.rect.h),v.point&&(E=v.point.x,C=v.point.y);let _=1/m.width;return new P.Rect(E*_-S*_/2*(w-1),C*_-A*_/2*(w-1),S*_*w,A*_*w)}(z,w,v);null==S||S.viewport.fitBounds(m)}}return O.createElement(iF,null,function(){var m,v;switch(T){case"text/plain":return O.createElement(viewer_ke,{value:R,handleClick:h});case"text/html":return O.createElement(un,{value:R,handleClick:h});case"text/vtt":return O.createElement(xn,{label:I[0].label,vttUri:I[0].id||""});case null==(m=T.match(/^image\//))?void 0:m.input:let w=(null==(v=I.find(m=>{var v;return!(null!=(v=m.id)&&v.includes("vault://"))}))?void 0:v.id)||"";return O.createElement(Hn,{caption:R,handleClick:h,imageUri:w});default:return O.createElement(viewer_ke,{value:R,handleClick:h})}}())},Vn=({annotationPage:m})=>{var v;let w=viewer_I(),{vault:E}=w;if(!m||!m.items||(null==(v=m.items)?void 0:v.length)===0)return O.createElement(O.Fragment,null);let C=m.items.map(m=>E.get(m.id));return C?O.createElement(ij,{"data-testid":"annotation-page"},null==C?void 0:C.map(m=>O.createElement(On,{key:m.id,annotation:m}))):O.createElement(O.Fragment,null)},iG=ig("div",{padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"scroll",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.45em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),iZ=ig("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),viewer_lt=(m,v="none")=>{if(!m)return null;if("string"==typeof m)return[m];if(!m[v]){let v=Object.getOwnPropertyNames(m);if(v.length>0)return m[v[0]]}return m[v]&&Array.isArray(m[v])?m[v]:null},viewer_R=(m,v="none",w=", ")=>{let E=viewer_lt(m,v);return Array.isArray(E)?E.join(`${w}`):E};function viewer_z(m,v){let w=Object.keys(m).filter(m=>v.includes(m)?null:m),E={};return w.forEach(v=>{E[v]=m[v]}),E}let iX=ig("span",{}),viewer_P=m=>{let{as:v,label:w}=m,E=viewer_z(m,["as","label"]);return O.createElement(iX,{as:v,...E},viewer_R(w,E.lang))},Dn=(m,v="200,",w="full")=>{let E;Array.isArray(m)&&(m=m[0]);let{id:C,service:S}=m;if(!S)return C;if(Array.isArray(m.service)&&m.service.length>0&&(E=S[0]),E){if(E["@id"])return`${E["@id"]}/${w}/${v}/0/default.jpg`;if(E.id)return`${E.id}/${w}/${v}/0/default.jpg`}},iQ=ig("img",{objectFit:"cover"}),Gn=m=>{let v;let w=(0,O.useRef)(null),{contentResource:E,altAsLabel:C,region:S="full"}=m;C&&(v=viewer_R(C));let A=viewer_z(m,["contentResource","altAsLabel"]),{type:_,id:k,width:I=200,height:P=200,duration:T}=E;(0,O.useEffect)(()=>{if(!k&&!w.current||["Image"].includes(_)||!k.includes("m3u8"))return;let m=new tj.ZP;return w.current&&(m.attachMedia(w.current),m.on(tj.ZP.Events.MEDIA_ATTACHED,function(){m.loadSource(k)})),m.on(tj.ZP.Events.ERROR,function(v,w){if(w.fatal)switch(w.type){case tj.ZP.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${v} network error encountered, try to recover`),m.startLoad();break;case tj.ZP.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${v} media error encountered, try to recover`),m.recoverMediaError();break;default:m.destroy()}}),()=>{m&&(m.detachMedia(),m.destroy())}},[k,_]);let R=(0,O.useCallback)(()=>{if(!w.current)return;let m=0,v=30;if(T&&(v=T),!k.split("#t=")&&T&&(m=.1*T),k.split("#t=").pop()){let v=k.split("#t=").pop();v&&(m=parseInt(v.split(",")[0]))}let E=w.current;E.autoplay=!0,E.currentTime=m,setTimeout(()=>R(),1e3*v)},[T,k]);(0,O.useEffect)(()=>R(),[R]);let z=Dn(E,`${I},${P}`,S);switch(_){case"Image":return O.createElement(iQ,{as:"img",alt:v,css:{width:I,height:P},key:k,src:z,...A});case"Video":return O.createElement(iQ,{as:"video",css:{width:I,height:P},disablePictureInPicture:!0,key:k,loop:!0,muted:!0,onPause:R,ref:w,src:k});default:return console.warn(`Resource type: ${_} is not valid or not yet supported in Primitives.`),O.createElement(O.Fragment,null)}},iY=ig("a",{}),jn=m=>{let{children:v,homepage:w}=m,E=viewer_z(m,["children","homepage"]);return O.createElement(O.Fragment,null,w&&w.map(m=>{let w=viewer_R(m.label,E.lang);return O.createElement(iY,{"aria-label":v?w:void 0,href:m.id,key:m.id,...E},v||w)}))},iJ={delimiter:", "},iK=(0,O.createContext)(void 0),viewer_st=()=>{let m=(0,O.useContext)(iK);if(void 0===m)throw Error("usePrimitivesContext must be used with a PrimitivesProvider");return m},viewer_pe=({children:m,initialState:v=iJ})=>{let w=Zn(v,"delimiter");return O.createElement(iK.Provider,{value:{delimiter:w}},m)},Zn=(m,v)=>Object.hasOwn(m,v)?m[v].toString():void 0,i0=ig("span",{}),viewer_Me=m=>{let{as:v,markup:w}=m,{delimiter:E}=viewer_st();if(!w)return O.createElement(O.Fragment,null);let C=viewer_z(m,["as","markup"]),S={__html:tL(viewer_R(w,C.lang,E),{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})};return O.createElement(i0,{as:v,...C,dangerouslySetInnerHTML:S})},viewer_ct=m=>O.useContext(iK)?O.createElement(viewer_Me,{...m}):O.createElement(viewer_pe,null,O.createElement(viewer_Me,{...m})),Yn=({as:m="dd",lang:v,value:w})=>O.createElement(viewer_ct,{markup:w,as:m,lang:v}),i1=ig("span",{}),Kn=({as:m="dd",customValueContent:v,lang:w,value:E})=>{var C;let{delimiter:S}=viewer_st(),A=null==(C=viewer_lt(E,w))?void 0:C.map(m=>(0,O.cloneElement)(v,{value:m}));return O.createElement(i1,{as:m,lang:w},null==A?void 0:A.map((m,v)=>[v>0&&`${S}`,O.createElement(O.Fragment,{key:v},m)]))},viewer_dt=m=>{var v;let{item:w,lang:E,customValueContent:C}=m,{label:S,value:A}=w,_=null==(v=viewer_R(S))?void 0:v.replace(" ","-").toLowerCase();return O.createElement("div",{role:"group","data-label":_},O.createElement(viewer_P,{as:"dt",label:S,lang:E}),C?O.createElement(Kn,{as:"dd",customValueContent:C,value:A,lang:E}):O.createElement(Yn,{as:"dd",value:A,lang:E}))},i2=ig("dl",{}),tr=m=>{let{as:v,customValueContent:w,metadata:E}=m;if(!Array.isArray(E))return O.createElement(O.Fragment,null);let C=viewer_Ge(m,"customValueDelimiter"),S=viewer_z(m,["as","customValueContent","customValueDelimiter","metadata"]);return O.createElement(viewer_pe,{..."string"==typeof C?{initialState:{delimiter:C}}:void 0},E.length>0&&O.createElement(i2,{as:v,...S},E.map((m,v)=>{let E=w?function(m,v){let w=v.filter(v=>{let{matchingLabel:w}=v,E=Object.keys(v.matchingLabel)[0],C=viewer_R(w,E);if(viewer_R(m,E)===C)return!0}).map(m=>m.Content);if(Array.isArray(w))return w[0]}(m.label,w):void 0;return O.createElement(viewer_dt,{customValueContent:E,item:m,key:v,lang:null==S?void 0:S.lang})})))};ig("li",{}),ig("ul",{});let i4=ig("li",{}),i3=ig("ul",{}),or=m=>{let{as:v,rendering:w}=m,E=viewer_z(m,["as","rendering"]);return O.createElement(i3,{as:v},w&&w.map(m=>{let v=viewer_R(m.label,E.lang);return O.createElement(i4,{key:m.id},O.createElement("a",{href:m.id,...E,target:"_blank"},v||m.id))}))},i6=ig("dl",{}),ir=m=>{let{as:v,requiredStatement:w}=m;if(!w)return O.createElement(O.Fragment,null);let E=viewer_Ge(m,"customValueDelimiter"),C=viewer_z(m,["as","customValueDelimiter","requiredStatement"]);return O.createElement(viewer_pe,{..."string"==typeof E?{initialState:{delimiter:E}}:void 0},O.createElement(i6,{as:v,...C},O.createElement(viewer_dt,{item:w,lang:C.lang})))},i5=ig("li",{}),i8=ig("ul",{}),cr=m=>{let{as:v,seeAlso:w}=m,E=viewer_z(m,["as","seeAlso"]);return O.createElement(i8,{as:v},w&&w.map(m=>{let v=viewer_R(m.label,E.lang);return O.createElement(i5,{key:m.id},O.createElement("a",{href:m.id,...E},v||m.id))}))},dr=m=>{let{as:v,summary:w}=m,E=viewer_z(m,["as","customValueDelimiter","summary"]);return O.createElement(viewer_ct,{as:v,markup:w,...E})},viewer_mt=m=>{let{thumbnail:v,region:w}=m,E=viewer_z(m,["thumbnail"]);return O.createElement(O.Fragment,null,v&&v.map(m=>O.createElement(Gn,{contentResource:m,key:m.id,region:w,...E})))},mr=({homepage:m})=>(null==m?void 0:m.length)===0?O.createElement(O.Fragment,null):O.createElement(O.Fragment,null,O.createElement("span",{className:"manifest-property-title"},"Homepage"),O.createElement(jn,{homepage:m})),ur=({id:m,htmlLabel:v,parent:w="manifest"})=>O.createElement(O.Fragment,null,O.createElement("span",{className:"manifest-property-title"},v),O.createElement("a",{href:m,target:"_blank",id:`iiif-${w}-id`},m)),pr=({metadata:m,parent:v="manifest"})=>m?O.createElement(O.Fragment,null,O.createElement(tr,{metadata:m,id:`iiif-${v}-metadata`})):O.createElement(O.Fragment,null),fr=({rendering:m})=>(null==m?void 0:m.length)===0?O.createElement(O.Fragment,null):O.createElement(O.Fragment,null,O.createElement("span",{className:"manifest-property-title"},"Alternate formats"),O.createElement(or,{rendering:m})),hr=({requiredStatement:m,parent:v="manifest"})=>m?O.createElement(O.Fragment,null,O.createElement(ir,{requiredStatement:m,id:`iiif-${v}-required-statement`})):O.createElement(O.Fragment,null),gr=({rights:m})=>m?O.createElement(O.Fragment,null,O.createElement("span",{className:"manifest-property-title"},"Rights"),O.createElement("a",{href:m,target:"_blank"},m)):O.createElement(O.Fragment,null),vr=({seeAlso:m})=>(null==m?void 0:m.length)===0?O.createElement(O.Fragment,null):O.createElement(O.Fragment,null,O.createElement("span",{className:"manifest-property-title"},"See Also"),O.createElement(cr,{seeAlso:m})),yr=({summary:m,parent:v="manifest"})=>m?O.createElement(O.Fragment,null,O.createElement(dr,{summary:m,as:"p",id:`iiif-${v}-summary`})):O.createElement(O.Fragment,null),xr=({label:m,thumbnail:v})=>(null==v?void 0:v.length)===0?O.createElement(O.Fragment,null):O.createElement(O.Fragment,null,O.createElement(viewer_mt,{altAsLabel:m||{none:["resource"]},thumbnail:v,style:{backgroundColor:"#6663",objectFit:"cover"}})),br=()=>{let m=viewer_I(),{activeManifest:v,vault:w}=m,[E,C]=(0,O.useState)(),[S,A]=(0,O.useState)([]),[_,k]=(0,O.useState)([]),[I,P]=(0,O.useState)([]),[T,R]=(0,O.useState)([]);return(0,O.useEffect)(()=>{var m,E,S,_;let I=w.get(v);C(I),(null==(m=I.homepage)?void 0:m.length)>0&&A(w.get(I.homepage)),(null==(E=I.seeAlso)?void 0:E.length)>0&&k(w.get(I.seeAlso)),(null==(S=I.rendering)?void 0:S.length)>0&&P(w.get(I.rendering)),(null==(_=I.thumbnail)?void 0:_.length)>0&&R(w.get(I.thumbnail))},[v,w]),E?O.createElement(iZ,null,O.createElement(iG,null,O.createElement(xr,{thumbnail:T,label:E.label}),O.createElement(yr,{summary:E.summary}),O.createElement(pr,{metadata:E.metadata}),O.createElement(hr,{requiredStatement:E.requiredStatement}),O.createElement(gr,{rights:E.rights}),O.createElement(mr,{homepage:S}),O.createElement(vr,{seeAlso:_}),O.createElement(fr,{rendering:I}),O.createElement(ur,{id:E.id,htmlLabel:"IIIF Manifest"}))):O.createElement(O.Fragment,null)},Er=({activeCanvas:m,annotationResources:v})=>{let w=viewer_F(),E=viewer_I(),{isAutoScrolling:C,configOptions:{informationPanel:S},isUserScrolling:A}=E,[_,k]=(0,O.useState)(),I=null==S?void 0:S.renderAbout,P=null==S?void 0:S.renderAnnotation;return(0,O.useEffect)(()=>{I?k("manifest-about"):v&&(null==v?void 0:v.length)>0&&!I&&k(v[0].id)},[m,I,v]),O.createElement(iP,{"data-testid":"information-panel",defaultValue:_,onValueChange:m=>{k(m)},orientation:"horizontal",value:_,className:"clover-viewer-information-panel"},O.createElement(iT,{"aria-label":"select chapter","data-testid":"information-panel-list"},I&&O.createElement(iR,{value:"manifest-about"},"About"),P&&v&&v.map((m,v)=>O.createElement(iR,{key:v,value:m.id},O.createElement(viewer_P,{label:m.label})))),O.createElement(iM,{handleScroll:function(){if(!C){clearTimeout(A);let m=setTimeout(()=>{w({type:"updateUserScrolling",isUserScrolling:void 0})},1500);w({type:"updateUserScrolling",isUserScrolling:m})}}},I&&O.createElement(iO,{value:"manifest-about"},O.createElement(br,null)),P&&v&&v.map(m=>O.createElement(iO,{key:m.id,value:m.id},O.createElement(Vn,{annotationPage:m})))))},i9=ig("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),i7=ig("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),ne=ig("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),nt=ig("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"}}),nr=ig("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${i9}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}}),Ir=(m,v)=>{(0,O.useEffect)(()=>{function r(w){w.key===m&&v()}return window.addEventListener("keyup",r),()=>window.removeEventListener("keyup",r)},[])},$r=()=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},O.createElement("title",null,"Arrow Back"),O.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),Ar=()=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},O.createElement("title",null,"Arrow Forward"),O.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),Tr=()=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},O.createElement("title",null,"Close"),O.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Mr=()=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},O.createElement("title",null,"Search"),O.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),Rr=({handleCanvasToggle:m,handleFilter:v,activeIndex:w,canvasLength:E})=>{let[C,S]=(0,O.useState)(!1),[A,_]=(0,O.useState)(!1),[k,I]=(0,O.useState)(!1);return(0,O.useEffect)(()=>{I(0===w),w===E-1?_(!0):_(!1)},[w,E]),Ir("Escape",()=>{S(!1),v("")}),O.createElement(nr,{isToggle:C},O.createElement(i9,null,C&&O.createElement(i7,{autoFocus:!0,onChange:m=>v(m.target.value),placeholder:"Search"}),!C&&O.createElement(nt,null,O.createElement(ne,{onClick:()=>m(-1),disabled:k,type:"button"},O.createElement($r,null)),O.createElement("span",null,w+1," of ",E),O.createElement(ne,{onClick:()=>m(1),disabled:A,type:"button"},O.createElement(Ar,null))),O.createElement(ne,{onClick:()=>{S(m=>!m),v("")},type:"button"},C?O.createElement(Tr,null):O.createElement(Mr,null))))},ni=ig(r_.fC,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem",overflowX:"scroll",position:"relative",zIndex:"0"}),nn=ig("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}}),viewer_A=m=>O.createElement(nn,{...m,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},m.children);viewer_A.Title=({children:m})=>O.createElement("title",null,m),viewer_A.Add=()=>O.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),viewer_A.Audio=()=>O.createElement(O.Fragment,null,O.createElement("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),O.createElement("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),O.createElement("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})),viewer_A.Close=()=>O.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),viewer_A.Image=()=>O.createElement("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),viewer_A.Video=()=>O.createElement("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"});let na=iy({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),no=iy({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),nl=ig(io.Eh,{fill:"$secondaryAlt"}),ns=ig(io.x8,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),nc=ig(io.VY,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:no},'&[data-side="bottom"]':{animationName:na},'&[data-align="end"]':{[`& ${nl}`]:{margin:"0 0.7rem"}}}),nd=ig(io.xz,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),nu=ig(io.fC,{boxSizing:"content-box"}),viewer_j=({children:m})=>O.createElement(nu,null,m);viewer_j.Trigger=m=>O.createElement(nd,{...m},m.children),viewer_j.Content=m=>O.createElement(nc,{...m},O.createElement(nl,null),O.createElement(ns,null,O.createElement(viewer_A,{isSmall:!0},O.createElement(viewer_A.Close,null))),m.children);let np=ig("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"5px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},[`${nn}`]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}}),nm=ig("span",{display:"flex"}),nh=ig("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),nf=ig("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),ng=ig(r_.ck,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},figure:{margin:"0",width:"161.8px","> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all",img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${nm}`]:{position:"absolute",right:"0",bottom:"0",[`& ${np}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}},figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${nm}`]:{[`& ${np}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700"}}}),Yr=({type:m})=>{switch(m){case"Sound":return O.createElement(viewer_A.Audio,null);case"Image":default:return O.createElement(viewer_A.Image,null);case"Video":return O.createElement(viewer_A.Video,null)}},Jr=({canvas:m,canvasIndex:v,isActive:w,thumbnail:E,type:C,handleChange:S})=>O.createElement(ng,{"aria-checked":w,"data-testid":"media-thumbnail","data-canvas":v,onClick:()=>S(m.id),value:m.id},O.createElement("figure",null,O.createElement("div",null,(null==E?void 0:E.id)&&O.createElement("img",{src:E.id,alt:null!=m&&m.label?viewer_U(m.label):""}),O.createElement(nm,null,O.createElement(np,{isIcon:!0,"data-testid":"thumbnail-tag"},O.createElement(nh,null),O.createElement(viewer_A,{"aria-label":C},O.createElement(Yr,{type:C})),["Video","Sound"].includes(C)&&O.createElement(nf,null,viewer_We(m.duration))))),(null==m?void 0:m.label)&&O.createElement("figcaption",{"data-testid":"fig-caption"},O.createElement(viewer_P,{label:m.label})))),Kr=m=>m.body?m.body.type:"Image",Qr=({items:m})=>{let v=viewer_F(),w=viewer_I(),{activeCanvas:E,vault:C}=w,[S,A]=(0,O.useState)(""),[_,k]=(0,O.useState)([]),[I,P]=(0,O.useState)(0),T=O.useRef(null),p=m=>{E!==m&&v({type:"updateActiveCanvas",canvasId:m})};return(0,O.useEffect)(()=>{if(!_.length){let v=["Image","Sound","Video"],w=m.map(m=>viewer_Ze(C,m,"painting",v)).filter(m=>m.annotations.length>0);k(w)}},[m,_.length,C]),(0,O.useEffect)(()=>{_.forEach((m,v)=>{null!=m&&m.canvas&&m.canvas.id===E&&P(v)})},[E,_]),(0,O.useEffect)(()=>{let m=document.querySelector(`[data-canvas="${I}"]`);if(m instanceof HTMLElement&&T.current){let v=m.offsetLeft-T.current.offsetWidth/2+m.offsetWidth/2;T.current.scrollTo({left:v,behavior:"smooth"})}},[I]),O.createElement(O.Fragment,null,O.createElement(Rr,{handleFilter:m=>A(m),handleCanvasToggle:m=>{let v=_[I+m];null!=v&&v.canvas&&p(v.canvas.id)},activeIndex:I,canvasLength:_.length}),O.createElement(ni,{"aria-label":"select item","data-testid":"media",ref:T},_.filter(m=>{var v;if(null!=(v=m.canvas)&&v.label){let v=viewer_U(m.canvas.label);if(Array.isArray(v))return v[0].toLowerCase().includes(S.toLowerCase())}}).map((m,v)=>{var w,S;return O.createElement(Jr,{canvas:m.canvas,canvasIndex:v,handleChange:p,isActive:E===(null==(w=null==m?void 0:m.canvas)?void 0:w.id),key:null==(S=null==m?void 0:m.canvas)?void 0:S.id,thumbnail:Jt(C,m,200,200),type:Kr(m.annotations[0])})})))},nv=ig("button",{position:"absolute",background:"none",border:"none",cursor:"zoom-in",margin:"0",padding:"0",width:"100%",height:"100%",transition:"$all","& img":{width:"100%",height:"100%",objectFit:"contain",color:"transparent",transition:"$all"},variants:{isMedia:{true:{cursor:"pointer"}}}}),ny=ig("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),nw=ig(ny,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),nb=ig("div",{position:"relative",display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",gap:"1rem",zIndex:"0",overflow:"hidden","&:hover":{[`${nw}`]:{backgroundColor:"$accent"},[`${nv}`]:{backgroundColor:"#6662"}}}),nx=ig("div",{width:"100%",height:"100%"}),nE=ig("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),nC=ig(il.xz,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",cursor:"pointer",transition:"$all",border:"1px solid #6663",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem",width:"100%","@sm":{fontSize:"1rem"}}),nS=ig(il.VY,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),nA=ig(il.ck,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),n_=ig(il.__,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),nk=ig(il.fC,{position:"relative",zIndex:"5",width:"100%"}),viewer_re=({direction:m,title:v})=>O.createElement(nE,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},O.createElement("title",null,v),"up"===m&&O.createElement(()=>O.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),null),"down"===m&&O.createElement(()=>O.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"}),null)),xt=({children:m,label:v,maxHeight:w,onValueChange:E,value:C})=>O.createElement(nk,{onValueChange:E,value:C},O.createElement(nC,{"data-testid":"select-button"},O.createElement(il.ki,{"data-testid":"select-button-value"}),O.createElement(il.GV,null,O.createElement(viewer_re,{direction:"down",title:"select"}))),O.createElement(il.ue,null,O.createElement(nS,{css:{maxHeight:`${w} !important`},"data-testid":"select-content"},O.createElement(il.Pn,null,O.createElement(viewer_re,{direction:"up",title:"scroll up for more"})),O.createElement(il.Q_,null,O.createElement(il.DI,null,v&&O.createElement(n_,null,O.createElement(viewer_P,{"data-testid":"select-label",label:v})),m)),O.createElement(il.Jk,null,O.createElement(viewer_re,{direction:"down",title:"scroll down for more"}))))),bt=m=>O.createElement(nA,{...m},m.thumbnail&&O.createElement(viewer_mt,{thumbnail:m.thumbnail}),O.createElement(il.S_,null,O.createElement(viewer_P,{label:m.label})),O.createElement(il.o6,null)),nI=ig("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),n$=ig("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),nP=ig("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${nI}`]:{display:"block"}},false:{[`${nI}`]:{display:"none"}}}}}),viewer_B=({className:m,id:v,label:w,children:E})=>{let C=w.toLowerCase().replace(/\s/g,"-");return O.createElement(ny,{id:v,className:m,"data-testid":"openseadragon-button","data-button":C},O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${v}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},O.createElement("title",{id:`${v}-svg-title`},w),E))},nT=ig("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),mo=()=>O.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),uo=()=>O.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),po=()=>O.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),fo=()=>O.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),viewer_Re=()=>O.createElement(O.Fragment,null,O.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),O.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),ho=({_cloverViewerHasPlaceholder:m,config:v})=>O.createElement(nT,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:m},v.showZoomControl&&O.createElement(O.Fragment,null,O.createElement(viewer_B,{id:v.zoomInButton,label:"zoom in"},O.createElement(mo,null)),O.createElement(viewer_B,{id:v.zoomOutButton,label:"zoom out"},O.createElement(uo,null))),v.showFullPageControl&&O.createElement(viewer_B,{id:v.fullPageButton,label:"full page"},O.createElement(po,null)),v.showRotationControl&&O.createElement(O.Fragment,null,O.createElement(viewer_B,{id:v.rotateRightButton,label:"rotate right"},O.createElement(viewer_Re,null)),O.createElement(viewer_B,{id:v.rotateLeftButton,label:"rotate left"},O.createElement(viewer_Re,null))),v.showHomeControl&&O.createElement(viewer_B,{id:v.homeButton,label:"reset"},O.createElement(fo,null))),go=({ariaLabel:m,config:v,uri:w,_cloverViewerHasPlaceholder:E,imageType:C,openSeadragonCallback:S})=>{let[A,_]=(0,O.useState)(),[k,I]=(0,O.useState)();return(0,O.useEffect)(()=>(k||I(P(v)),()=>null==k?void 0:k.destroy()),[]),(0,O.useEffect)(()=>{k&&S&&S(k)},[k,S]),(0,O.useEffect)(()=>{w!==A&&_(w)},[A,w]),(0,O.useEffect)(()=>{if(A&&k)switch(C){case"simpleImage":k.addSimpleImage({url:A});break;case"tiledImage":wn(A).then(m=>{try{if(!m)throw Error(`No tile source found for ${A}`);k.addTiledImage({tileSource:m})}catch(m){console.error(m)}});break;default:k.close(),console.warn(`Unable to render ${A} in OpenSeadragon as type: "${C}"`)}},[C,A,k]),O.createElement(nP,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":v.id,hasNavigator:v.showNavigator},O.createElement(ho,{_cloverViewerHasPlaceholder:E,config:v}),v.showNavigator&&O.createElement(nI,{id:v.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),O.createElement(n$,{id:v.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...m&&{"aria-label":m}}))},yo=({_cloverViewerHasPlaceholder:m=!1,body:v,instanceId:w,isTiledImage:E=!1,label:C,src:S="",openSeadragonCallback:A,openSeadragonConfig:_={}})=>{let k=w||esm_browser_v4(),I="string"==typeof C?C:viewer_R(C),P={id:`openseadragon-${k}`,navigatorId:`openseadragon-navigator-${k}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${k}`,homeButton:`reset-${k}`,rotateLeftButton:`rotateLeft-${k}`,rotateRightButton:`rotateRight-${k}`,zoomInButton:`zoomIn-${k}`,zoomOutButton:`zoomOut-${k}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1},..._},{imageType:R,uri:z}=v?Ln(v):Fn(S,E);return z?O.createElement(T.SV,{FallbackComponent:viewer_Xe},O.createElement(go,{_cloverViewerHasPlaceholder:m,ariaLabel:I,config:P,imageType:R,key:k,uri:z,openSeadragonCallback:A})):null},xo=({isMedia:m,label:v,placeholderCanvas:w,setIsInteractive:E})=>{let{vault:C}=viewer_I(),S=viewer_q(C,w),A=S?S[0]:void 0,_=v?viewer_U(v):["placeholder image"];return O.createElement(nv,{onClick:()=>E(!0),isMedia:m,className:"clover-viewer-placeholder"},O.createElement("img",{src:(null==A?void 0:A.id)||"",alt:_.join(),height:null==A?void 0:A.height,width:null==A?void 0:A.width}))},nR=ig("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),nO=O.forwardRef((m,v)=>{let w=O.useRef(null),E=(0,O.useCallback)(()=>{var m,E;if(null!=(m=v.current)&&m.currentTime&&(null==(E=v.current)?void 0:E.currentTime)>0)return;let C=v.current;if(!C)return;let S=new AudioContext,A=S.createMediaElementSource(C),_=S.createAnalyser(),k=w.current;if(!k)return;k.width=C.offsetWidth,k.height=C.offsetHeight;let I=k.getContext("2d");A.connect(_),_.connect(S.destination),_.fftSize=256;let P=_.frequencyBinCount,T=new Uint8Array(P);setInterval(function(){!function(m,v,w,E,C,S){let A=C/w*2.6,_,k=0;m.getByteFrequencyData(E),v.fillStyle="#000000",v.fillRect(0,0,C,S);for(let m=0;m<w;m++)_=2*E[m],v.fillStyle="rgba(78, 42, 132, 1)",v.fillRect(k,S-_,A,_),k+=A+6}(_,I,P,T,k.width,k.height)},20)},[v]);return O.useEffect(()=>{v&&v.current&&(v.current.onplay=E)},[E,v]),O.createElement(nR,{ref:w,role:"presentation"})}),nM=ig("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",height:"100%",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}}),So=({resource:m,ignoreCaptionLabels:v})=>{let w=viewer_U(m.label,"en");return Array.isArray(w)&&w.some(m=>v.includes(m))?null:O.createElement("track",{key:m.id,src:m.id,label:Array.isArray(w)?w[0]:w,srcLang:"en","data-testid":"player-track"})},Co=({allSources:m,annotationResources:v,painting:w})=>{let[E,C]=O.useState(0),[S,A]=O.useState(),_=O.useRef(null),k=(null==w?void 0:w.type)==="Sound",I=viewer_I(),{activeCanvas:P,configOptions:T,vault:R}=I;return(0,O.useEffect)(()=>{if(!w.id||!_.current)return;if(null!=_&&_.current){let m=_.current;m.src=w.id,m.load()}if("m3u8"!==w.id.split(".").pop())return;let m=new tj.ZP({xhrSetup:function(m,v){m.withCredentials=!!T.withCredentials}});return m.attachMedia(_.current),m.on(tj.ZP.Events.MEDIA_ATTACHED,function(){m.loadSource(w.id)}),m.on(tj.ZP.Events.ERROR,function(v,w){if(w.fatal)switch(w.type){case tj.ZP.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${v} network error encountered, try to recover`),m.startLoad();break;case tj.ZP.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${v} media error encountered, try to recover`),m.recoverMediaError();break;default:m.destroy()}}),()=>{if(m&&_.current){let v=_.current;m.detachMedia(),m.destroy(),v.currentTime=0}}},[T.withCredentials,w.id]),(0,O.useEffect)(()=>{var m,v,w,C;let S=R.get(P),_=null!=(m=S.accompanyingCanvas)&&m.id?viewer_q(R,null==(v=S.accompanyingCanvas)?void 0:v.id):null,k=null!=(w=S.placeholderCanvas)&&w.id?viewer_q(R,null==(C=S.placeholderCanvas)?void 0:C.id):null;_&&k?A(0===E?k[0].id:_[0].id):(_&&A(_[0].id),k&&A(k[0].id))},[P,E,R]),(0,O.useEffect)(()=>{if(null!=_&&_.current){let m=_.current;return null==m||m.addEventListener("timeupdate",()=>C(m.currentTime)),()=>document.removeEventListener("timeupdate",()=>{})}},[]),O.createElement(nM,{css:{backgroundColor:T.canvasBackgroundColor,maxHeight:T.canvasHeight,position:"relative"},"data-testid":"player-wrapper",className:"clover-viewer-player-wrapper"},O.createElement("video",{id:"clover-iiif-video",key:w.id,ref:_,controls:!0,height:w.height,width:w.width,crossOrigin:"anonymous",poster:S,style:{maxHeight:T.canvasHeight,position:"relative",zIndex:"1"}},m.map(m=>O.createElement("source",{src:m.id,type:m.format,key:m.id})),(null==v?void 0:v.length)>0&&v.map(m=>{let v=[];return m.items.forEach(m=>{R.get(m.id).body.forEach(m=>{let w=R.get(m.id);v.push(w)})}),v.map(m=>O.createElement(So,{resource:m,ignoreCaptionLabels:T.ignoreCaptionLabels||[],key:m.id}))}),"Sorry, your browser doesn't support embedded videos."),k&&O.createElement(nO,{ref:_}))},ko=()=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},O.createElement("title",{id:"close-svg-title"},"close"),O.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Io=({isMedia:m})=>O.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},O.createElement("title",{id:"open-svg-title"},"open"),m?O.createElement("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):O.createElement(O.Fragment,null,O.createElement("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),O.createElement("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"}))),$o=({handleToggle:m,isInteractive:v,isMedia:w})=>O.createElement(nw,{onClick:m,isInteractive:v,isMedia:w,"data-testid":"placeholder-toggle"},v?O.createElement(ko,null):O.createElement(Io,{isMedia:w})),Ao=({activeCanvas:m,annotationResources:v,isMedia:w,painting:E})=>{var C,S,A,_,k,I;let[T,R]=O.useState(0),[z,L]=O.useState(!1),{configOptions:F,customDisplays:N,openSeadragonViewer:q,vault:Z,viewerId:Q}=viewer_I(),K=viewer_F(),et=Z.get(m),er=null==(C=null==et?void 0:et.placeholderCanvas)?void 0:C.id,ei=!!er,en=(null==E?void 0:E.length)>1,ea=er&&!z&&!w,eo=`${Q}-${Dt(m+T)}`,el=N.find(v=>{var w;let C=!1,{canvasId:S,paintingFormat:A}=v.target;if(Array.isArray(S)&&S.length>0&&(C=S.includes(m)),Array.isArray(A)&&A.length>0){let m=(null==(w=E[T])?void 0:w.format)||"";C=!!(m&&A.includes(m))}return C}),es=[];null==(A=null==(S=v[0])?void 0:S.items)||A.forEach(m=>{let v=Z.get(m.id);es.push(v)}),(0,O.useEffect)(()=>{var m;es&&q&&null!=(m=F.annotationOverlays)&&m.renderOverlays&&function(m,v,w,E){if(!m)return;let C=1/v.width;E.forEach(v=>{if(!v.target)return;let E=viewer_at(v.target),{point:S,rect:A,svg:_}=E;if(A){let{x:v,y:E,w:S,h:_}=A;(function(m,v,w,E,C,S){let A=new P.Rect(v,w,E,C),_=document.createElement("div");if(S.annotationOverlays){let{backgroundColor:m,opacity:v,borderType:w,borderColor:E,borderWidth:C}=S.annotationOverlays;_.style.backgroundColor=m,_.style.opacity=v,_.style.border=`${w} ${C} ${E}`,_.className="annotation-overlay"}m.addOverlay(_,A)})(m,v*C,E*C,S*C,_*C,w)}if(S){let{x:v,y:E}=S,A=`
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
          <circle cx="${v}" cy="${E}" r="20" />
        </svg>
      `;viewer_Ae(m,A,w,C)}_&&viewer_Ae(m,_,w,C)})}(q,et,F,es)},[null==et?void 0:et.id,es,q,null==(_=F.annotationOverlays)?void 0:_.renderOverlays]);let ec=null==(k=null==el?void 0:el.display)?void 0:k.component;return O.createElement(nb,{className:"clover-viewer-painting"},O.createElement(nx,{style:{backgroundColor:F.canvasBackgroundColor,height:"auto"===F.canvasHeight?"100%":F.canvasHeight}},er&&!w&&O.createElement($o,{handleToggle:()=>L(!z),isInteractive:z,isMedia:w}),ea&&!w&&O.createElement(xo,{isMedia:w,label:null==et?void 0:et.label,placeholderCanvas:er,setIsInteractive:L}),!ea&&!el&&(w?O.createElement(Co,{allSources:E,painting:E[T],annotationResources:v}):E&&O.createElement(yo,{_cloverViewerHasPlaceholder:ei,body:E[T],instanceId:eo,key:eo,openSeadragonCallback:m=>{m&&(null==q?void 0:q.id)!==`openseadragon-${eo}`&&K({type:"updateOpenSeadragonViewer",openSeadragonViewer:m})},openSeadragonConfig:F.openSeadragon})),!ea&&ec&&O.createElement(ec,{id:m,annotationBody:E[T],...null==el?void 0:el.display.componentProps})),en&&O.createElement(xt,{value:null==(I=E[T])?void 0:I.id,onValueChange:m=>{let v=E.findIndex(v=>v.id===m);R(v)},maxHeight:"200px"},null==E?void 0:E.map(m=>O.createElement(bt,{value:null==m?void 0:m.id,key:null==m?void 0:m.id,label:null==m?void 0:m.label}))))},To=({activeCanvas:m,annotationResources:v,isAudioVideo:w,items:E,painting:C})=>{let{isInformationOpen:S,configOptions:A}=viewer_I(),{informationPanel:_}=A,k=(null==_?void 0:_.renderAbout)&&S,I=(null==_?void 0:_.renderAnnotation)&&v.length>0&&!_.open;return console.log(k,I),O.createElement(iS,{className:"clover-viewer-content","data-testid":"clover-viewer-content"},O.createElement(iA,null,O.createElement(Ao,{activeCanvas:m,annotationResources:v,isMedia:w,painting:C}),k&&O.createElement(i_,null,O.createElement("span",null,S?"View Items":"More Information")),E.length>1&&O.createElement(iC,{className:"clover-viewer-media-wrapper"},O.createElement(Qr,{items:E,activeItem:0}))),(k||I)&&O.createElement(iI,null,O.createElement(ik,null,O.createElement(Er,{activeCanvas:m,annotationResources:v}))))},nz=ig(viewer_j.Trigger,{width:"30px",padding:"5px"}),nL=ig(viewer_j.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),nj=ig("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),nF=ig("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",[`> ${nk}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),nH=ig("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"}),Ho=()=>{var m;let v=viewer_F(),w=viewer_I(),{activeManifest:E,collection:C,configOptions:S,vault:A}=w,_=null==S?void 0:S.canvasHeight;return O.createElement("div",{style:{margin:"0.75rem"}},O.createElement(xt,{label:C.label,maxHeight:_,value:E,onValueChange:m=>{v({type:"updateActiveManifest",manifestId:m}),v({type:"updateViewerId",viewerId:esm_browser_v4()})}},null==(m=null==C?void 0:C.items)?void 0:m.map(m=>O.createElement(bt,{value:m.id,key:m.id,thumbnail:null!=m&&m.thumbnail?A.get(null==m?void 0:m.thumbnail):void 0,label:m.label}))))},Oo=(m,v=2500)=>{let[w,E]=(0,O.useState)(),C=(0,O.useCallback)(()=>{navigator.clipboard.writeText(m).then(()=>E("copied"),()=>E("failed"))},[m]);return(0,O.useEffect)(()=>{if(!w)return;let m=setTimeout(()=>E(void 0),v);return()=>clearTimeout(m)},[w]),[w,C]},nN=ig("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",fontSize:"0.6111rem",textTransform:"uppercase",lineHeight:"1em"}),Bo=({status:m})=>m?O.createElement(nN,{"data-copy-status":m},m):null,viewer_ze=({textPrompt:m,textToCopy:v})=>{let[w,E]=Oo(v);return O.createElement("button",{onClick:E},m," ",O.createElement(Bo,{status:w}))},Po=()=>{let m="#ed1d33",v="#2873ab";return O.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},O.createElement("title",null,"IIIF Manifest Options"),O.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},O.createElement("g",{transform:"scale(0.1)"},O.createElement("path",{style:{fill:v},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),O.createElement("path",{style:{fill:v},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),O.createElement("path",{style:{fill:m},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),O.createElement("path",{style:{fill:m},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),O.createElement("path",{style:{fill:v},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),O.createElement("path",{style:{fill:v},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),O.createElement("path",{style:{fill:m},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},nB=ig(is.fC,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),nD=ig(is.bU,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))"}}),nW=ig("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"}),nV=ig("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),Go=()=>{var m;let{configOptions:v}=viewer_I(),w=viewer_F(),[E,C]=(0,O.useState)(null==(m=null==v?void 0:v.informationPanel)?void 0:m.open);return(0,O.useEffect)(()=>{w({type:"updateInformationOpen",isInformationOpen:E})},[E,w]),O.createElement(nV,null,O.createElement(nW,{htmlFor:"information-toggle",css:E?{opacity:"1"}:{}},"More Information"),O.createElement(nB,{checked:E,onCheckedChange:()=>C(!E),id:"information-toggle","aria-label":"information panel toggle",name:"toggled?"},O.createElement(nD,null)))},wt=m=>{let n=()=>!!window.matchMedia&&window.matchMedia(m).matches,[v,w]=(0,O.useState)(n);return(0,O.useEffect)(()=>{let o=()=>w(n);return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)}),v},Uo=({manifestId:m,manifestLabel:v})=>{let w=viewer_I(),{collection:E,configOptions:C}=w,{showTitle:S,showIIIFBadge:A,informationPanel:_}=C,k=A||(null==_?void 0:_.renderToggle),I=wt(ih.sm);return O.createElement(nF,{className:"clover-viewer-header"},null!=E&&E.items?O.createElement(Ho,null):O.createElement(nj,{className:S?"":"visually-hidden"},S&&O.createElement(viewer_P,{label:v,className:"label"})),k&&O.createElement(nH,null,A&&O.createElement(viewer_j,null,O.createElement(nz,null,O.createElement(Po,null)),O.createElement(nL,null,(null==E?void 0:E.items)&&O.createElement("button",{onClick:m=>{m.preventDefault(),window.open(E.id,"_blank")}},"View Collection"),O.createElement("button",{onClick:v=>{v.preventDefault(),window.open(m,"_blank")}},"View Manifest")," ",(null==E?void 0:E.items)&&O.createElement(viewer_ze,{textPrompt:"Copy Collection URL",textToCopy:E.id}),O.createElement(viewer_ze,{textPrompt:"Copy Manifest URL",textToCopy:m}))),(null==_?void 0:_.renderToggle)&&!I&&O.createElement(Go,null)))},jo=(m=!1)=>{let[v,w]=(0,O.useState)(m);return(0,O.useLayoutEffect)(()=>{if(!v)return;let m=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=m}},[v]),(0,O.useEffect)(()=>{v!==m&&w(m)},[m]),[v,w]},qo=({manifest:m,theme:v})=>{var w;let E=viewer_I(),C=viewer_F(),{activeCanvas:S,isInformationOpen:A,vault:_,configOptions:k}=E,I=(null==k?void 0:k.canvasHeight)&&["100%","auto"].includes(null==k?void 0:k.canvasHeight),[P,R]=(0,O.useState)(!1),[z,L]=(0,O.useState)(!1),[F,N]=(0,O.useState)([]),[q,Z]=(0,O.useState)([]),[Q,K]=jo(!1),et=wt(ih.sm),er=(0,O.useCallback)(m=>{C({type:"updateInformationOpen",isInformationOpen:m})},[C]);return(0,O.useEffect)(()=>{var m;null!=(m=null==k?void 0:k.informationPanel)&&m.open&&er(!et)},[et,null==(w=null==k?void 0:k.informationPanel)?void 0:w.open,er]),(0,O.useEffect)(()=>{if(!et){K(!1);return}K(A)},[A,et,K]),(0,O.useEffect)(()=>{let m=viewer_q(_,S);m&&(L(["Sound","Video"].indexOf(m[0].type)>-1),N(m));let v=Yt(_,S);v.length>0&&C({type:"updateInformationOpen",isInformationOpen:!0}),Z(v),R(0!==v.length)},[S,_,C]),O.createElement(T.SV,{FallbackComponent:viewer_Xe},O.createElement(i$,{className:`${v} clover-viewer`,css:{background:null==k?void 0:k.background},"data-body-locked":Q,"data-absolute-position":I,"data-information-panel":P,"data-information-panel-open":A},O.createElement(rS.fC,{open:A,onOpenChange:er},O.createElement(Uo,{manifestLabel:m.label,manifestId:m.id}),O.createElement(To,{activeCanvas:S,painting:F,annotationResources:q,items:m.items,isAudioVideo:z}))))},nU={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function viewer_Fe(m,v=null){return{ok:!1,status:m.status,statusText:m.statusText,headers:m.getAllResponseHeaders(),data:v||m.statusText,json:()=>JSON.parse(v||m.statusText)}}let da=({canvasIdCallback:m=()=>{},customDisplays:v=[],customTheme:w,iiifContent:E,id:C,manifestId:S,options:A})=>{var _,k,I;let P=E;C&&(P=C),S&&(P=S);let T=viewer_Ue(null==(k=null==(_=null==A?void 0:A.informationPanel)?void 0:_.vtt)?void 0:k.autoScroll);return O.createElement(Xt,{initialState:{...iu,customDisplays:v,isAutoScrollEnabled:T.enabled,isInformationOpen:!!(null!=(I=null==A?void 0:A.informationPanel)&&I.open),vault:new Vault({customFetcher:m=>(function(m,v=nU){let w=v.headers||nU.headers;return new Promise((E,C)=>{let S=new XMLHttpRequest;S.open("get",m),S.withCredentials=v.withCredentials,w&&Object.keys(w).forEach(m=>S.setRequestHeader(m,w[m])),S.onload=()=>{E({ok:S.status>=200&&S.status<300,status:S.status,statusText:S.statusText,headers:S.getAllResponseHeaders(),data:S.responseText,json:()=>JSON.parse(S.responseText)})},S.onerror=()=>{C(viewer_Fe(S,"Failed to make request."))},S.ontimeout=()=>{C(viewer_Fe(S,"Request took longer than expected."))},S.send()})})(m,{withCredentials:null==A?void 0:A.withCredentials,headers:null==A?void 0:A.requestHeaders}).then(m=>JSON.parse(m.data))})}},O.createElement(Yo,{iiifContent:P,canvasIdCallback:m,customTheme:w,options:A}))},Yo=({canvasIdCallback:m,customTheme:v,iiifContent:w,options:E})=>{let C=viewer_F(),S=viewer_I(),{activeCanvas:A,activeManifest:_,isLoaded:k,vault:I}=S,[P,T]=(0,O.useState)(),[z,L]=(0,O.useState)(),F={};return v&&(F=(0,R.jG)("custom",v)),(0,O.useEffect)(()=>{m&&m(A)},[A,m]),(0,O.useEffect)(()=>{_&&I.loadManifest(_).then(m=>{L(m),C({type:"updateActiveCanvas",canvasId:Cn(w,m)})}).catch(m=>{console.error(`Manifest failed to load: ${m}`)}).finally(()=>{C({type:"updateIsLoaded",isLoaded:!0})})},[w,_,C,I]),(0,O.useEffect)(()=>{C({type:"updateConfigOptions",configOptions:E});let m=Sn(w);I.load(m).then(m=>{T(m)}).catch(m=>{console.error(`The IIIF resource ${w} failed to load: ${m}`)})},[C,w,E,I]),(0,O.useEffect)(()=>{if((null==P?void 0:P.type)==="Collection"){C({type:"updateCollection",collection:P});let m=kn(w,P);m&&C({type:"updateActiveManifest",manifestId:m})}else(null==P?void 0:P.type)==="Manifest"&&C({type:"updateActiveManifest",manifestId:P.id})},[C,w,P]),k?z&&z.items?0===z.items.length?(console.log(`The IIIF manifest ${w} does not contain canvases.`),O.createElement(O.Fragment,null)):O.createElement(qo,{manifest:z,theme:F,key:z.id}):(console.log(`The IIIF manifest ${w} failed to load.`),O.createElement(O.Fragment,null)):O.createElement(O.Fragment,null,"Loading")};var nq=da}}]);